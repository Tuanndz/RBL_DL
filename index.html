<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Roblox Download</title>
    <meta property="og:title" content="Roblox Download">
    <meta property="og:description" content="download roblox hackk x·ªãn v√†a script v·ªõi cloud ugphonee cree Tuann">
    <meta property="og:image" content="https://files.catbox.moe/mlq4is.jpg">
    <meta property="og:url" content="">
    <meta name="twitter:card" content="summary_large_image">
    <style>
        /* CSS Variables - Updated with glassmorphism and gradient colors */
        :root {
            --primary-color: #006AFF;
            --primary-dark: #0051cc;
            --primary-light: #4d94ff;
            --secondary-color: #9c27b0;
            --secondary-light: #d05ce3;
            --success-color: #00e676;
            --success-light: rgba(0, 230, 118, 0.1);
            --danger-color: #ff5252;
            --warning-color: #ffd740;
            --light-color: #f8f9fa;
            --dark-color: #121212;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --background-color: #ffffff;
            --card-background: rgba(255, 255, 255, 0.8);
            --border-color: rgba(0, 106, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --gradient-primary: linear-gradient(135deg, #006AFF, #9c27b0);
            --gradient-secondary: linear-gradient(135deg, #4d94ff, #d05ce3);
            --gradient-dark: linear-gradient(135deg, #121212, #1a1a2e);
            --gradient-card: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            --border-radius: 20px;
            --font-primary: 'Poppins', sans-serif;
            --font-secondary: 'Montserrat', sans-serif;
        }

        [data-theme="dark"] {
            --primary-color: #4d94ff;
            --primary-dark: #006AFF;
            --primary-light: #80b3ff;
            --secondary-color: #d05ce3;
            --secondary-light: #e891f5;
            --success-color: #00e676;
            --success-light: rgba(0, 230, 118, 0.2);
            --danger-color: #ff5252;
            --warning-color: #ffd740;
            --light-color: #1e1e1e;
            --dark-color: #f8f9fa;
            --text-primary: #f8f9fa;
            --text-secondary: #adb5bd;
            --background-color: #121212;
            --card-background: rgba(30, 30, 30, 0.8);
            --border-color: rgba(77, 148, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --glass-bg: rgba(30, 30, 30, 0.25);
            --glass-border: rgba(77, 148, 255, 0.18);
            --gradient-primary: linear-gradient(135deg, #4d94ff, #d05ce3);
            --gradient-secondary: linear-gradient(135deg, #80b3ff, #e891f5);
            --gradient-dark: linear-gradient(135deg, #121212, #1a1a2e);
            --gradient-card: linear-gradient(135deg, rgba(30, 30, 30, 0.9), rgba(30, 30, 30, 0.7));
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            touch-action: manipulation;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: var(--font-primary);
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.5s ease;
            overflow-x: hidden;
            position: relative;
        }

        /* Custom Background */
        .custom-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            opacity: 0.2;
            transition: opacity 0.5s ease;
        }

        .custom-background.video {
            opacity: 0.3;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--card-background);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.8s ease forwards;
        }

        /* Screen Management */
        .screen {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .screen.active {
            display: block;
            opacity: 1;
            animation: fadeIn 0.8s ease;
        }

        /* Login Screen - Updated with glassmorphism */
        .login-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: var(--gradient-primary);
            position: relative;
            overflow: hidden;
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: pulse 15s infinite linear;
            z-index: 0;
        }

        @keyframes pulse {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .logo {
            margin-bottom: 40px;
            text-align: center;
            z-index: 1;
            position: relative;
        }

        .logo h1 {
            color: white;
            font-size: 3.5rem;
            font-weight: 700;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #ffffff, #e0e0e0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-form {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 450px;
            z-index: 1;
            position: relative;
            transition: all 0.3s ease;
        }

        .login-form:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .login-form h2 {
            margin-bottom: 24px;
            text-align: center;
            color: white;
            font-weight: 600;
            font-size: 1.8rem;
        }

        .input-group {
            margin-bottom: 20px;
            position: relative;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-size: 16px;
            background-color: rgba(255, 255, 255, 0.9);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: var(--font-primary);
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 106, 255, 0.2);
            background-color: white;
        }

        .btn-primary, .btn-secondary, .btn-tertiary {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
            font-family: var(--font-primary);
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 106, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 106, 255, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .btn-secondary:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: white;
        }

        .btn-tertiary {
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-tertiary:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
        }

        /* Registration Form */
        .registration-form {
            display: none;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 450px;
            z-index: 1;
            position: relative;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .registration-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .gender-selection {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .gender-option {
            flex: 1;
            text-align: center;
        }

        .gender-option input {
            display: none;
        }

        .gender-option label {
            display: block;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gender-option input:checked + label {
            border-color: white;
            background: rgba(255, 255, 255, 0.2);
        }

        /* Main App */
        .navbar {
            background: var(--gradient-primary);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            height: 60px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-logo h2 {
            color: white;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .nav-menu {
            display: flex;
            gap: 8px;
        }

        .nav-btn {
            padding: 8px 16px;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 12px;
        }

        .nav-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 3px;
            background: white;
            transition: width 0.3s ease;
        }

        .nav-btn.active, .nav-btn:hover {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-btn.active::after, .nav-btn:hover::after {
            width: 100%;
        }

        .nav-btn img {
            width: 20px;
            height: 20px;
            margin-bottom: 4px;
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-user span {
            font-weight: 500;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .edit-name-btn {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .edit-name-btn:hover {
            transform: scale(1.2);
        }

        .music-btn {
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            padding: 5px;
            border-radius: 50%;
        }

        .music-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .coins-display {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--warning-color);
            font-weight: 600;
            padding: 5px 10px;
            background: rgba(255, 215, 64, 0.2);
            border-radius: 10px;
        }

        /* Main Content */
        .main-content {
            padding: 30px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .page.active {
            display: block;
            opacity: 1;
            animation: fadeIn 0.5s ease;
        }

        .page-title {
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            text-align: center;
        }

        /* Search Bars */
        .search-container {
            display: flex;
            margin-bottom: 20px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            background-color: var(--card-background);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 106, 255, 0.2);
        }

        .search-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient-primary);
            border: none;
            cursor: pointer;
            margin-left: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .search-btn:hover {
            transform: scale(1.1);
        }

        .search-btn img {
            width: 24px;
            height: 24px;
            filter: brightness(0) invert(1);
        }

        /* Search Results Info */
        .search-results-info {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 16px;
        }

        /* Games Grid */
        .games-grid, .clouds-grid, .groups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .game-card, .cloud-card, .group-card {
            background: var(--gradient-card);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .game-card:hover, .cloud-card:hover, .group-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .game-card img, .cloud-card img, .group-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .game-card:hover img, .cloud-card:hover img, .group-card:hover img {
            transform: scale(1.05);
        }

        .game-info, .cloud-info, .group-info {
            padding: 15px;
        }

        .game-info h3, .cloud-info h3, .group-info h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .cloud-stats {
            display: flex;
            gap: 10px;
        }

        .like-btn, .dislike-btn {
            padding: 5px 10px;
            border: 1px solid var(--border-color);
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .like-btn.active, .dislike-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .like-btn.disabled, .dislike-btn.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .vote-cooldown {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 5px;
            text-align: center;
        }

        /* Settings */
        .settings-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .account-card {
            display: flex;
            align-items: center;
            gap: 20px;
            background: var(--gradient-card);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .avatar {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .avatar:hover img {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 106, 255, 0.3);
        }

        .avatar-upload {
            position: absolute;
            bottom: 5px;
            right: 5px;
        }

        .avatar-upload-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .avatar-upload-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .avatar-upload-btn span {
            font-size: 16px;
            color: white;
        }

        .account-info {
            flex: 1;
        }

        .account-info h3 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .diamonds {
            color: var(--warning-color);
            font-weight: 600;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--secondary-color);
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Social Links */
        .social-links {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }

        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: var(--gradient-card);
            border-radius: 12px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            overflow: hidden;
        }

        .social-link img {
            width: 32px;
            height: 32px;
            object-fit: contain;
        }

        .social-link:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* Daily Login */
        .daily-login {
            background: var(--gradient-card);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            margin: 20px 0;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        .daily-login h3 {
            margin-bottom: 15px;
            text-align: center;
        }

        .daily-calendar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .day-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            background: var(--light-color);
            transition: all 0.3s ease;
            flex: 1;
            margin: 0 5px;
        }

        .day-item.active {
            background: var(--primary-color);
            color: white;
        }

        .day-item.claimed {
            background: var(--success-color);
            color: white;
        }

        .day-name {
            font-size: 12px;
            margin-bottom: 5px;
        }

        .day-coins {
            font-size: 14px;
            font-weight: 600;
        }

        .daily-actions {
            display: flex;
            gap: 10px;
        }

        .daily-actions input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            background: var(--card-background);
            color: var(--text-primary);
            font-size: 14px;
        }

        .daily-actions input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(0, 106, 255, 0.2);
        }

        /* Popups */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .popup-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .popup-content {
            background: var(--gradient-card);
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow);
            text-align: center;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .popup-overlay.active .popup-content {
            transform: scale(1);
        }

        .popup-avatar {
            margin-bottom: 20px;
        }

        .popup-avatar img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
        }

        .popup-content h3 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .popup-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .popup-buttons button {
            flex: 1;
        }

        .popup-notification label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .game-detail-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        /* Music Player */
        .music-player {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-card);
            z-index: 1000;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: none;
            flex-direction: column;
        }

        .music-player.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .music-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--gradient-primary);
            color: white;
            height: 60px;
        }

        .music-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            padding: 20px;
            gap: 30px;
        }

        .music-album-art {
            width: 300px;
            height: 300px;
            border-radius: 20px;
            object-fit: cover;
            box-shadow: var(--shadow);
        }

        .music-search-container {
            display: flex;
            width: 100%;
            max-width: 400px;
            margin: 0 auto 20px;
        }

        .music-search-input {
            flex: 1;
            padding: 12px 20px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            background-color: var(--card-background);
            color: var(--text-primary);
            font-size: 16px;
        }

        .music-search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 106, 255, 0.2);
        }

        .music-control-buttons {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .music-control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 20px;
            color: white;
        }

        .music-control-btn:hover {
            transform: scale(1.1);
        }

        .music-control-btn.play-pause {
            width: 80px;
            height: 80px;
            font-size: 30px;
        }

        .auto-next-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-secondary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 16px;
            color: white;
            margin-top: 10px;
        }

        .auto-next-btn.active {
            background: var(--success-color);
        }

        .auto-next-btn:hover {
            transform: scale(1.1);
        }

        .volume-control {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-btn {
            background: transparent;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-primary);
        }

        .music-list {
            position: absolute;
            top: 80px;
            right: 20px;
            background: var(--gradient-card);
            border-radius: var(--border-radius);
            padding: 15px;
            max-width: 300px;
            width: 100%;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: var(--shadow);
            display: none;
        }

        .music-list.active {
            display: block;
        }

        .music-item {
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .music-item:hover {
            background: rgba(0, 106, 255, 0.1);
        }

        .music-item.active {
            background: rgba(0, 106, 255, 0.2);
        }

        /* Music Title Animation */
        .music-title-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            overflow: hidden;
            position: relative;
            height: 30px;
        }

        .music-title {
            white-space: nowrap;
            position: absolute;
            animation: scrollText 15s linear infinite;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        @keyframes scrollText {
            0% {
                transform: translateX(100%);
            }
            90% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        .music-title.paused {
            animation-play-state: paused;
        }

        /* Cloud Viewer */
        .cloud-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--background-color);
            z-index: 999;
            display: none;
            flex-direction: column;
        }

        .cloud-overlay.active {
            display: flex;
        }

        .cloud-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            background: var(--gradient-primary);
            color: white;
            height: 60px;
        }

        .cloud-content {
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .cloud-content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Empty State Styles */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state p {
            font-size: 18px;
            margin: 0;
        }

        /* Checkbox Group */
        .checkbox-group {
            margin: 15px 0;
            text-align: left;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        /* Cloud Purchase Options */
        .cloud-purchase-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .purchase-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: var(--light-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .purchase-option:hover {
            background: rgba(0, 106, 255, 0.1);
        }

        .purchase-option.selected {
            background: rgba(0, 106, 255, 0.2);
            border: 1px solid var(--primary-color);
        }

        .purchase-info {
            display: flex;
            flex-direction: column;
        }

        .purchase-duration {
            font-weight: 600;
        }

        .purchase-price {
            color: var(--warning-color);
            font-weight: 600;
        }

        /* Background App Runner */
        .background-runner {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 998;
            transition: all 0.3s ease;
        }

        .background-runner:hover {
            transform: scale(1.1);
        }

        .background-runner img {
            width: 30px;
            height: 30px;
            filter: brightness(0) invert(1);
        }

        /* Zalo Button */
        .zalo-button {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #0068FF;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 998;
            transition: all 0.3s ease;
        }

        .zalo-button:hover {
            transform: scale(1.1);
        }

        .zalo-button img {
            width: 36px;
            height: 36px;
            filter: brightness(0) invert(1);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success-color);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 1001;
            display: none;
            align-items: center;
            gap: 10px;
            max-width: 300px;
            animation: slideInRight 0.3s ease;
        }

        .notification.show {
            display: flex;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-icon {
            font-size: 20px;
        }

        /* Drag and Drop Styles */
        .drag-drop-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            cursor: pointer;
        }

        .drag-drop-area.active {
            border-color: var(--primary-color);
            background-color: rgba(0, 106, 255, 0.05);
        }

        .drag-drop-area p {
            margin: 0;
            color: var(--text-secondary);
        }

        .drag-drop-icon {
            font-size: 40px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        /* Background Settings */
        .background-preview {
            width: 100%;
            height: 150px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
            position: relative;
        }

        .background-preview img,
        .background-preview video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .background-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .background-controls button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .background-controls .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .background-controls .btn-secondary {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                height: auto;
                padding: 15px;
            }

            .nav-menu {
                margin: 15px 0;
                flex-wrap: wrap;
                justify-content: center;
            }

            .nav-user {
                margin-top: 10px;
            }

            .games-grid, .clouds-grid, .groups-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }

            .account-card {
                flex-direction: column;
                text-align: center;
            }

            .avatar {
                width: 80px;
                height: 80px;
            }

            .avatar-upload-btn {
                width: 28px;
                height: 28px;
            }

            .avatar-upload-btn span {
                font-size: 14px;
            }

            .popup-buttons {
                flex-direction: column;
            }

            .dev-tabs {
                flex-wrap: wrap;
            }

            .cloud-overlay {
                width: 100%;
            }

            .daily-calendar {
                flex-wrap: wrap;
            }

            .day-item {
                flex: 0 0 calc(33.333% - 10px);
                margin-bottom: 10px;
            }

            .music-album-art {
                width: 250px;
                height: 250px;
            }

            .music-control-buttons {
                gap: 15px;
            }

            .music-control-btn {
                width: 50px;
                height: 50px;
            }

            .music-control-btn.play-pause {
                width: 70px;
                height: 70px;
            }

            .music-title-container {
                max-width: 300px;
            }

            .music-search-container {
                max-width: 350px;
            }
        }

        @media (max-width: 480px) {
            .login-form {
                padding: 30px 20px;
            }

            .logo h1 {
                font-size: 2.5rem;
            }

            .games-grid, .clouds-grid, .groups-grid {
                grid-template-columns: 1fr;
            }

            .dev-container {
                width: 95%;
            }

            .daily-calendar {
                flex-direction: column;
            }

            .day-item {
                margin-bottom: 10px;
            }

            .music-album-art {
                width: 200px;
                height: 200px;
            }

            .music-control-buttons {
                gap: 10px;
            }

            .music-control-btn {
                width: 45px;
                height: 45px;
            }

            .music-control-btn.play-pause {
                width: 60px;
                height: 60px;
            }

            .music-title-container {
                max-width: 250px;
            }

            .music-search-container {
                max-width: 300px;
            }
        }

        @media (max-height: 600px) and (orientation: landscape) {
            .login-container {
                padding: 10px;
            }

            .logo {
                margin-bottom: 20px;
            }

            .logo h1 {
                font-size: 2rem;
            }

            .login-form {
                padding: 20px;
                max-width: 350px;
            }

            .nav-container {
                padding: 10px 15px;
                height: 50px;
            }

            .nav-btn {
                padding: 6px 12px;
                font-size: 10px;
            }

            .nav-btn img {
                width: 16px;
                height: 16px;
            }

            .main-content {
                padding: 15px 10px;
            }

            .page-title {
                margin-bottom: 15px;
                font-size: 1.5rem;
            }

            .games-grid, .clouds-grid, .groups-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 10px;
            }

            .game-card img, .cloud-card img, .group-card img {
                height: 120px;
            }

            .game-info, .cloud-info, .group-info {
                padding: 10px;
            }

            .music-album-art {
                width: 150px;
                height: 150px;
            }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Custom Background -->
    <img id="customBackgroundImage" class="custom-background" src="" alt="Background Image" style="display: none;">
    <video id="customBackgroundVideo" class="custom-background video" loop muted style="display: none;"></video>

    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="logo">
                <h1>Game Center</h1>
            </div>
            <div class="login-form">
                <h2>ƒêƒÉng nh·∫≠p</h2>
                <div class="input-group">
                    <input type="text" id="username" placeholder="T√™n ƒëƒÉng nh·∫≠p">
                </div>
                <div class="input-group">
                    <input type="password" id="password" placeholder="M·∫≠t kh·∫©u">
                </div>
                <button id="loginBtn" class="btn-primary">ƒêƒÉng nh·∫≠p</button>
                <button id="registerBtn" class="btn-secondary">ƒêƒÉng k√Ω</button>
                <button id="guestBtn" class="btn-tertiary">Ti·∫øp t·ª•c v·ªõi t∆∞ c√°ch kh√°ch</button>
            </div>
            
            <!-- Registration Form -->
            <div class="registration-form" id="registrationForm">
                <h2>ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
                <div class="input-group">
                    <input type="text" id="regUsername" placeholder="T√™n ƒëƒÉng nh·∫≠p">
                </div>
                <div class="input-group">
                    <input type="password" id="regPassword" placeholder="M·∫≠t kh·∫©u">
                </div>
                <div class="input-group">
                    <input type="password" id="confirmPassword" placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u">
                </div>
                <div class="gender-selection">
                    <div class="gender-option">
                        <input type="radio" id="male" name="gender" value="male">
                        <label for="male">Nam</label>
                    </div>
                    <div class="gender-option">
                        <input type="radio" id="female" name="gender" value="female">
                        <label for="female">N·ªØ</label>
                    </div>
                </div>
                <button id="createAccountBtn" class="btn-primary">T·∫°o t√†i kho·∫£n</button>
                <button id="backToLoginBtn" class="btn-tertiary">Quay l·∫°i ƒëƒÉng nh·∫≠p</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="screen">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <h2>Game Center</h2>
                </div>
                <div class="nav-menu">
                    <button class="nav-btn active" data-page="download">
                        <img src="https://cdn-icons-png.flaticon.com/512/724/724933.png" alt="Download">
                        <span>Download</span>
                    </button>
                    <button class="nav-btn" data-page="cloud">
                        <img src="https://cdn-icons-png.flaticon.com/512/1163/1163734.png" alt="Cloud">
                        <span>Cloud</span>
                    </button>
                    <button class="nav-btn" data-page="groups">
                        <img src="https://cdn-icons-png.flaticon.com/512/2462/2462719.png" alt="Groups">
                        <span>Groups</span>
                    </button>
                    <button class="nav-btn" data-page="settings">
                        <img src="https://cdn-icons-png.flaticon.com/512/2099/2099153.png" alt="Settings">
                        <span>Settings</span>
                    </button>
                </div>
                <div class="nav-user">
                    <span id="userDisplay">Admin <button class="edit-name-btn" id="editNameBtn">‚úèÔ∏è</button></span>
                    <div class="coins-display" id="coinsDisplay">üí∞ 0</div>
                    <button class="music-btn" id="musicToggleBtn">üéµ</button>
                </div>
            </div>
        </nav>

        <!-- Pages -->
        <main class="main-content">
            <!-- Download Page -->
            <div id="downloadPage" class="page active">
                <h2 class="page-title">Roblox-script</h2>
                <div class="search-container">
                    <input type="text" id="downloadSearch" class="search-input" placeholder="T√¨m ki·∫øm game...">
                    <button class="search-btn" id="downloadSearchBtn">
                        <img src="https://cdn-icons-png.flaticon.com/512/149/149852.png" alt="Search">
                    </button>
                </div>
                <div class="search-results-info" id="downloadSearchResults"></div>
                <div class="games-grid" id="gamesGrid">
                    <!-- Games will be loaded here -->
                </div>
            </div>

            <!-- Cloud Page -->
            <div id="cloudPage" class="page">
                <h2 class="page-title">Cloud</h2>
                <div class="search-container">
                    <input type="text" id="cloudSearch" class="search-input" placeholder="T√¨m ki·∫øm cloud...">
                    <button class="search-btn" id="cloudSearchBtn">
                        <img src="https://cdn-icons-png.flaticon.com/512/149/149852.png" alt="Search">
                    </button>
                </div>
                <div class="search-results-info" id="cloudSearchResults"></div>
                <div class="clouds-grid" id="cloudsGrid">
                    <!-- Clouds will be loaded here -->
                </div>
            </div>

            <!-- Groups Page -->
            <div id="groupsPage" class="page">
                <h2 class="page-title">Zalo Groups</h2>
                <div class="groups-grid" id="groupsGrid">
                    <!-- Groups will be loaded here -->
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settingsPage" class="page">
                <h2 class="page-title">C√†i ƒë·∫∑t</h2>
                <div class="settings-container">
                    <div class="account-card">
                        <div class="avatar">
                            <img id="accountAvatar" src="https://cdn2.fptshop.com.vn/small/avatar_trang_1_cd729c335b.jpg" alt="Avatar">
                            <div class="avatar-upload">
                                <label for="avatarUpload" class="avatar-upload-btn">
                                    <span>üì∑</span>
                                </label>
                                <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
                            </div>
                        </div>
                        <div class="account-info">
                            <h3 id="accountName">Admin <button class="edit-name-btn" id="editNameBtn2">‚úèÔ∏è</button></h3>
                            <p class="diamonds" id="accountDiamonds">9999 Kim c∆∞∆°ng</p>
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="themeSwitch">Ch·∫ø ƒë·ªô t·ªëi</label>
                        <label class="switch">
                            <input type="checkbox" id="themeSwitch">
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <label for="backgroundRunner">Ch·∫°y n·ªÅn ·ª©ng d·ª•ng</label>
                        <label class="switch">
                            <input type="checkbox" id="backgroundRunner">
                            <span class="slider"></span>
                        </label>
                    </div>

                    <!-- Background Settings -->
                    <div class="setting-item">
                        <label for="backgroundSettings">H√¨nh n·ªÅn</label>
                        <button id="backgroundSettingsBtn" class="btn-secondary">Thay ƒë·ªïi</button>
                    </div>

                    <!-- Social Links -->
                    <div class="social-links">
                        <div class="social-link" id="youtubeLink">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/YouTube_full-color_icon_%282017%29.svg/2560px-YouTube_full-color_icon_%282017%29.svg.png" alt="YouTube">
                        </div>
                        <div class="social-link" id="zaloLink">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMDg68zSJU2TpKyMFJwkWpuGsXF_FTMJguqA&s" alt="Zalo">
                        </div>
                        <div class="social-link" id="facebookLink">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/Facebook_f_logo_%282019%29.svg/2048px-Facebook_f_logo_%282019%29.svg.png" alt="Facebook">
                        </div>
                    </div>

                    <!-- Daily Login -->
                    <div class="daily-login">
                        <h3>ƒêƒÉng nh·∫≠p h√†ng ng√†y</h3>
                        <div class="daily-calendar" id="dailyCalendar">
                            <!-- Days will be populated by JavaScript -->
                        </div>
                        <div class="daily-actions">
                            <input type="text" id="codeInput" placeholder="Nh·∫≠p m√£ code ƒë·ªÉ nh·∫≠n xu">
                            <button id="claimCodeBtn" class="btn-primary">Nh·∫≠n xu</button>
                        </div>
                    </div>

                    <div id="zaloGroupsContainer">
                        <!-- Zalo groups will be loaded here -->
                    </div>

                    <button id="devModeBtn" class="btn-secondary">Ch·∫ø ƒë·ªô ph√°t tri·ªÉn</button>
                    <button id="logoutBtn" class="btn-tertiary">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Background App Runner -->
    <div id="backgroundRunnerBtn" class="background-runner">
        <img src="https://cdn-icons-png.flaticon.com/512/1828/1828817.png" alt="Run in Background">
    </div>

    <!-- Zalo Button -->
    <div id="zaloButton" class="zalo-button">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMDg68zSJU2TpKyMFJwkWpuGsXF_FTMJguqA&s" alt="Zalo">
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="notification-icon">‚úì</div>
        <div class="notification-text"></div>
    </div>

    <!-- Welcome Popup -->
    <div id="welcomePopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-avatar">
                <img id="popupAvatar" src="https://files.catbox.moe/mlq4is.jpg" alt="Avatar">
            </div>
            <h3>B·∫°n ƒë√£ tham gia nh√≥m Roblox ch∆∞a?</h3>
            <div class="popup-buttons">
                <button id="notJoinedBtn" class="btn-primary">Ch∆∞a tham gia</button>
                <button id="alreadyJoinedBtn" class="btn-secondary">ƒê√£ tham gia</button>
            </div>
            <div class="popup-notification">
                <label>
                    <input type="checkbox" id="disableNotification">
                    T·∫Øt th√¥ng b√°o trong 2 gi·ªù
                </label>
            </div>
        </div>
    </div>

    <!-- Game Detail Popup -->
    <div id="gameDetailPopup" class="popup-overlay">
        <div class="popup-content">
            <img id="gameDetailImage" src="" alt="Game Image" class="game-detail-img">
            <h3 id="gameDetailTitle"></h3>
            <p>B·∫°n c√≥ mu·ªën download game n√†y kh√¥ng?</p>
            <div class="popup-buttons">
                <button id="downloadGameBtn" class="btn-primary">Download</button>
                <button id="cancelDownloadBtn" class="btn-secondary">H·ªßy</button>
            </div>
        </div>
    </div>

    <!-- Name Edit Popup -->
    <div id="nameEditPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>ƒê·ªïi t√™n hi·ªÉn th·ªã</h3>
            <div class="input-group">
                <input type="text" id="newNameInput" placeholder="Nh·∫≠p t√™n m·ªõi">
            </div>
            <div class="popup-buttons">
                <button id="saveNameBtn" class="btn-primary">L∆∞u</button>
                <button id="cancelNameBtn" class="btn-secondary">H·ªßy</button>
            </div>
        </div>
    </div>

    <!-- Cloud Purchase Popup -->
    <div id="cloudPurchasePopup" class="popup-overlay">
        <div class="popup-content">
            <h3 id="cloudPurchaseTitle">Mua Cloud</h3>
            <p>Ch·ªçn g√≥i th·ªùi gian s·ª≠ d·ª•ng:</p>
            <div class="cloud-purchase-options">
                <div class="purchase-option" data-duration="6" data-price="50">
                    <div class="purchase-info">
                        <div class="purchase-duration">6 gi·ªù</div>
                    </div>
                    <div class="purchase-price">50 xu</div>
                </div>
                <div class="purchase-option" data-duration="12" data-price="150">
                    <div class="purchase-info">
                        <div class="purchase-duration">12 gi·ªù</div>
                    </div>
                    <div class="purchase-price">150 xu</div>
                </div>
                <div class="purchase-option" data-duration="24" data-price="299">
                    <div class="purchase-info">
                        <div class="purchase-duration">24 gi·ªù</div>
                    </div>
                    <div class="purchase-price">299 xu</div>
                </div>
                <div class="purchase-option" data-duration="infinite" data-price="999">
                    <div class="purchase-info">
                        <div class="purchase-duration">V√¥ h·∫°n</div>
                    </div>
                    <div class="purchase-price">999 xu</div>
                </div>
            </div>
            <div class="popup-buttons">
                <button id="confirmPurchaseBtn" class="btn-primary">Mua ngay</button>
                <button id="cancelPurchaseBtn" class="btn-secondary">H·ªßy</button>
            </div>
        </div>
    </div>

    <!-- Logout Confirmation Popup -->
    <div id="logoutConfirmPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>X√°c nh·∫≠n ƒëƒÉng xu·∫•t</h3>
            <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?</p>
            <div class="popup-buttons">
                <button id="confirmLogoutBtn" class="btn-primary">C√≥</button>
                <button id="cancelLogoutBtn" class="btn-secondary">Kh√¥ng</button>
            </div>
        </div>
    </div>

    <!-- Zalo Group Popup -->
    <div id="zaloGroupPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>Tham gia nh√≥m Zalo</h3>
            <p>B·∫°n c√≥ mu·ªën tham gia nh√≥m Zalo kh√¥ng?</p>
            <div class="popup-buttons">
                <button id="confirmZaloBtn" class="btn-primary">C√≥</button>
                <button id="cancelZaloBtn" class="btn-secondary">Kh√¥ng</button>
            </div>
        </div>
    </div>

    <!-- Music Player -->
    <div id="musicPlayer" class="music-player">
        <div class="music-header">
            <h3>Tr√¨nh ph√°t nh·∫°c</h3>
            <button id="closeMusicBtn" class="btn-close">_</button>
        </div>
        <div class="music-controls">
            <div class="music-search-container">
                <input type="text" id="musicSearchInput" class="music-search-input" placeholder="T√¨m ki·∫øm nh·∫°c...">
                <button id="toggleMusicList" class="btn-primary">T√¨m</button>
            </div>
            <img id="musicAlbumArt" src="https://files.catbox.moe/mlq4is.jpg" alt="Album Art" class="music-album-art">
            <div class="music-title-container">
                <div id="musicTitle" class="music-title"></div>
            </div>
            <div class="music-control-buttons">
                <button id="rewindBtn" class="music-control-btn">‚è™</button>
                <button id="playPauseBtn" class="music-control-btn play-pause">‚è∏Ô∏è</button>
                <button id="forwardBtn" class="music-control-btn">‚è©</button>
            </div>
            <button id="autoNextBtn" class="auto-next-btn" title="T·ª± ƒë·ªông chuy·ªÉn b√†i">A</button>
            <div class="volume-control">
                <button id="volumeBtn" class="volume-btn">üîä</button>
            </div>
        </div>
        <div class="music-list" id="musicList">
            <!-- Music list will be populated by JavaScript -->
        </div>
    </div>

    <!-- Cloud Viewer -->
    <div id="cloudViewer" class="cloud-overlay">
        <div class="cloud-header">
            <h3 id="cloudViewerTitle">Cloud Viewer</h3>
            <button id="closeCloud" class="btn-close">√ó</button>
        </div>
        <div class="cloud-content">
            <iframe id="cloudFrame" src="" frameborder="0" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
        </div>
    </div>

    <!-- Background Settings Popup -->
    <div id="backgroundSettingsPopup" class="popup-overlay">
        <div class="popup-content">
            <h3>Thay ƒë·ªïi h√¨nh n·ªÅn</h3>
            <div class="drag-drop-area" id="backgroundDragDrop">
                <div class="drag-drop-icon">üìÅ</div>
                <p>K√©o th·∫£ ·∫£nh ho·∫∑c video v√†o ƒë√¢y</p>
                <p class="small-text">(H·ªó tr·ª£: JPG, PNG, GIF, MP4, WebM - Video t·ªëi ƒëa 50MB)</p>
            </div>
            <div class="background-preview" id="backgroundPreview">
                <!-- Preview will be shown here -->
            </div>
            <div class="setting-item">
                <label for="backgroundSound">√Çm thanh video</label>
                <label class="switch">
                    <input type="checkbox" id="backgroundSound">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="background-controls">
                <button id="applyBackgroundBtn" class="btn-primary">√Åp d·ª•ng</button>
                <button id="resetBackgroundBtn" class="btn-secondary">M·∫∑c ƒë·ªãnh</button>
                <button id="cancelBackgroundBtn" class="btn-secondary">H·ªßy</button>
            </div>
        </div>
    </div>

    <!-- Developer Mode -->
    <div id="devMode" class="popup-overlay">
        <div class="dev-container">
            <div class="dev-header">
                <h2>Ch·∫ø ƒë·ªô ph√°t tri·ªÉn</h2>
                <button id="closeDevMode" class="btn-close">√ó</button>
            </div>
            
            <div class="dev-tabs">
                <button class="dev-tab active" data-tab="videos">Qu·∫£n l√Ω Video</button>
                <button class="dev-tab" data-tab="games">Qu·∫£n l√Ω Game</button>
                <button class="dev-tab" data-tab="clouds">Qu·∫£n l√Ω Cloud</button>
                <button class="dev-tab" data-tab="groups">Qu·∫£n l√Ω Groups</button>
                <button class="dev-tab" data-tab="popup">C√†i ƒë·∫∑t Popup</button>
                <button class="dev-tab" data-tab="importExport">Import/Export</button>
            </div>

            <div class="dev-content">
                <!-- Videos Tab -->
                <div id="videosTab" class="dev-tab-content active">
                    <h3>Th√™m Video YouTube</h3>
                    <div class="input-group">
                        <input type="text" id="videoUrl" placeholder="Link YouTube">
                        <button id="addVideoBtn" class="btn-primary">Th√™m video</button>
                    </div>
                    <div class="items-list" id="videosList">
                        <!-- Videos will be listed here -->
                    </div>
                </div>

                <!-- Games Tab -->
                <div id="gamesTab" class="dev-tab-content">
                    <h3>Th√™m Game</h3>
                    <div class="input-group">
                        <input type="text" id="gameName" placeholder="T√™n game">
                        <input type="text" id="gameLink" placeholder="Link download">
                        <input type="file" id="gameImage" accept="image/*">
                        <button id="addGameBtn" class="btn-primary">Th√™m game</button>
                    </div>
                    <div class="items-list" id="gamesList">
                        <!-- Games will be listed here -->
                    </div>
                </div>

                <!-- Clouds Tab -->
                <div id="cloudsTab" class="dev-tab-content">
                    <h3>Th√™m Cloud</h3>
                    <div class="input-group">
                        <input type="text" id="cloudName" placeholder="T√™n cloud">
                        <input type="text" id="cloudLink" placeholder="Link cloud">
                        <input type="file" id="cloudImage" accept="image/*">
                        <button id="addCloudBtn" class="btn-primary">Th√™m cloud</button>
                    </div>
                    <div class="items-list" id="cloudsList">
                        <!-- Clouds will be listed here -->
                    </div>
                </div>

                <!-- Groups Tab -->
                <div id="groupsTab" class="dev-tab-content">
                    <h3>Th√™m Group</h3>
                    <div class="input-group">
                        <input type="text" id="groupName" placeholder="T√™n group">
                        <input type="text" id="groupLink" placeholder="Link group">
                        <input type="file" id="groupImage" accept="image/*">
                        <button id="addGroupBtn" class="btn-primary">Th√™m group</button>
                    </div>
                    <div class="items-list" id="groupsList">
                        <!-- Groups will be listed here -->
                    </div>
                </div>

                <!-- Popup Tab -->
                <div id="popupTab" class="dev-tab-content">
                    <h3>C√†i ƒë·∫∑t Popup</h3>
                    <div class="input-group">
                        <input type="file" id="popupAvatarInput" accept="image/*">
                        <input type="text" id="popupLink" placeholder="Link chuy·ªÉn h∆∞·ªõng">
                        <input type="text" id="groupLink" placeholder="Link nh√≥m">
                        <button id="savePopupBtn" class="btn-primary">L∆∞u c√†i ƒë·∫∑t</button>
                    </div>
                </div>

                <!-- Import/Export Tab -->
                <div id="importExportTab" class="dev-tab-content">
                    <h3>Qu·∫£n l√Ω d·ªØ li·ªáu</h3>
                    <div class="data-actions">
                        <button id="exportDataBtn" class="btn-primary">Export JSON</button>
                        <input type="file" id="importDataInput" accept=".json">
                        <button id="importDataBtn" class="btn-secondary">Import JSON</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dev Login -->
    <div id="devLogin" class="popup-overlay">
        <div class="popup-content">
            <h3>ƒêƒÉng nh·∫≠p ch·∫ø ƒë·ªô ph√°t tri·ªÉn</h3>
            <div class="input-group">
                <input type="password" id="devPassword" placeholder="M·∫≠t kh·∫©u">
            </div>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="rememberDev">
                    L∆∞u ƒëƒÉng nh·∫≠p
                </label>
            </div>
            <div class="popup-buttons">
                <button id="confirmDevLogin" class="btn-primary">X√°c nh·∫≠n</button>
                <button id="cancelDevLogin" class="btn-secondary">H·ªßy</button>
            </div>
        </div>
    </div>

    <!-- Audio Element for Music -->
    <audio id="backgroundMusic" loop>
        <source src="" type="audio/mpeg">
    </audio>

    <script>
        // Global state
        let appState = {
            currentUser: null,
            isLoggedIn: false,
            isGuest: false,
            theme: localStorage.getItem('theme') || 'light',
            currentPage: 'download',
            devMode: false,
            cloudViewer: {
                isOpen: false,
                currentCloud: null
            },
            welcomePopup: {
                show: true,
                disabledUntil: null
            },
            music: {
                isPlaying: false,
                currentTrack: null,
                volume: 0.5,
                isMuted: false,
                autoNext: false
            },
            coins: parseInt(localStorage.getItem('coins')) || 0,
            dailyLogin: JSON.parse(localStorage.getItem('dailyLogin')) || {
                lastClaimed: null,
                streak: 0
            },
            purchasedClouds: JSON.parse(localStorage.getItem('purchasedClouds')) || {},
            backgroundRunner: localStorage.getItem('backgroundRunner') === 'true',
            customBackground: JSON.parse(localStorage.getItem('customBackground')) || {
                type: 'none', // 'none', 'image', 'video'
                data: null,
                soundEnabled: false
            }
        };

        // DOM Elements
        const elements = {
            // Screens
            loginScreen: document.getElementById('loginScreen'),
            mainApp: document.getElementById('mainApp'),
            
            // Login
            username: document.getElementById('username'),
            password: document.getElementById('password'),
            loginBtn: document.getElementById('loginBtn'),
            registerBtn: document.getElementById('registerBtn'),
            guestBtn: document.getElementById('guestBtn'),
            
            // Registration
            registrationForm: document.getElementById('registrationForm'),
            regUsername: document.getElementById('regUsername'),
            regPassword: document.getElementById('regPassword'),
            confirmPassword: document.getElementById('confirmPassword'),
            createAccountBtn: document.getElementById('createAccountBtn'),
            backToLoginBtn: document.getElementById('backToLoginBtn'),
            
            // Navigation
            navBtns: document.querySelectorAll('.nav-btn[data-page]'),
            userDisplay: document.getElementById('userDisplay'),
            coinsDisplay: document.getElementById('coinsDisplay'),
            logoutBtn: document.getElementById('logoutBtn'),
            editNameBtn: document.getElementById('editNameBtn'),
            editNameBtn2: document.getElementById('editNameBtn2'),
            musicToggleBtn: document.getElementById('musicToggleBtn'),
            
            // Pages
            downloadPage: document.getElementById('downloadPage'),
            cloudPage: document.getElementById('cloudPage'),
            groupsPage: document.getElementById('groupsPage'),
            settingsPage: document.getElementById('settingsPage'),
            
            // Content containers
            gamesGrid: document.getElementById('gamesGrid'),
            cloudsGrid: document.getElementById('cloudsGrid'),
            groupsGrid: document.getElementById('groupsGrid'),
            zaloGroupsContainer: document.getElementById('zaloGroupsContainer'),
            
            // Search
            downloadSearch: document.getElementById('downloadSearch'),
            downloadSearchBtn: document.getElementById('downloadSearchBtn'),
            downloadSearchResults: document.getElementById('downloadSearchResults'),
            cloudSearch: document.getElementById('cloudSearch'),
            cloudSearchBtn: document.getElementById('cloudSearchBtn'),
            cloudSearchResults: document.getElementById('cloudSearchResults'),
            
            // Settings
            accountName: document.getElementById('accountName'),
            accountAvatar: document.getElementById('accountAvatar'),
            accountDiamonds: document.getElementById('accountDiamonds'),
            themeSwitch: document.getElementById('themeSwitch'),
            backgroundRunner: document.getElementById('backgroundRunner'),
            backgroundSettingsBtn: document.getElementById('backgroundSettingsBtn'),
            devModeBtn: document.getElementById('devModeBtn'),
            avatarUpload: document.getElementById('avatarUpload'),
            
            // Social Links
            youtubeLink: document.getElementById('youtubeLink'),
            zaloLink: document.getElementById('zaloLink'),
            facebookLink: document.getElementById('facebookLink'),
            
            // Daily Login
            dailyCalendar: document.getElementById('dailyCalendar'),
            codeInput: document.getElementById('codeInput'),
            claimCodeBtn: document.getElementById('claimCodeBtn'),
            
            // Background Runner
            backgroundRunnerBtn: document.getElementById('backgroundRunnerBtn'),
            
            // Zalo Button
            zaloButton: document.getElementById('zaloButton'),
            
            // Notification
            notification: document.getElementById('notification'),
            notificationText: document.querySelector('.notification-text'),
            
            // Popups
            welcomePopup: document.getElementById('welcomePopup'),
            notJoinedBtn: document.getElementById('notJoinedBtn'),
            alreadyJoinedBtn: document.getElementById('alreadyJoinedBtn'),
            disableNotification: document.getElementById('disableNotification'),
            
            gameDetailPopup: document.getElementById('gameDetailPopup'),
            gameDetailImage: document.getElementById('gameDetailImage'),
            gameDetailTitle: document.getElementById('gameDetailTitle'),
            downloadGameBtn: document.getElementById('downloadGameBtn'),
            cancelDownloadBtn: document.getElementById('cancelDownloadBtn'),
            
            nameEditPopup: document.getElementById('nameEditPopup'),
            newNameInput: document.getElementById('newNameInput'),
            saveNameBtn: document.getElementById('saveNameBtn'),
            cancelNameBtn: document.getElementById('cancelNameBtn'),
            
            cloudPurchasePopup: document.getElementById('cloudPurchasePopup'),
            cloudPurchaseTitle: document.getElementById('cloudPurchaseTitle'),
            confirmPurchaseBtn: document.getElementById('confirmPurchaseBtn'),
            cancelPurchaseBtn: document.getElementById('cancelPurchaseBtn'),
            
            logoutConfirmPopup: document.getElementById('logoutConfirmPopup'),
            confirmLogoutBtn: document.getElementById('confirmLogoutBtn'),
            cancelLogoutBtn: document.getElementById('cancelLogoutBtn'),
            
            zaloGroupPopup: document.getElementById('zaloGroupPopup'),
            confirmZaloBtn: document.getElementById('confirmZaloBtn'),
            cancelZaloBtn: document.getElementById('cancelZaloBtn'),
            
            // Background Settings
            backgroundSettingsPopup: document.getElementById('backgroundSettingsPopup'),
            backgroundDragDrop: document.getElementById('backgroundDragDrop'),
            backgroundPreview: document.getElementById('backgroundPreview'),
            backgroundSound: document.getElementById('backgroundSound'),
            applyBackgroundBtn: document.getElementById('applyBackgroundBtn'),
            resetBackgroundBtn: document.getElementById('resetBackgroundBtn'),
            cancelBackgroundBtn: document.getElementById('cancelBackgroundBtn'),
            
            // Music Player
            musicPlayer: document.getElementById('musicPlayer'),
            closeMusicBtn: document.getElementById('closeMusicBtn'),
            musicSearchInput: document.getElementById('musicSearchInput'),
            toggleMusicList: document.getElementById('toggleMusicList'),
            musicAlbumArt: document.getElementById('musicAlbumArt'),
            musicTitle: document.getElementById('musicTitle'),
            rewindBtn: document.getElementById('rewindBtn'),
            playPauseBtn: document.getElementById('playPauseBtn'),
            forwardBtn: document.getElementById('forwardBtn'),
            autoNextBtn: document.getElementById('autoNextBtn'),
            volumeBtn: document.getElementById('volumeBtn'),
            musicList: document.getElementById('musicList'),
            backgroundMusic: document.getElementById('backgroundMusic'),
            
            // Cloud Viewer
            cloudViewer: document.getElementById('cloudViewer'),
            cloudViewerTitle: document.getElementById('cloudViewerTitle'),
            cloudFrame: document.getElementById('cloudFrame'),
            closeCloud: document.getElementById('closeCloud'),
            
            // Custom Background
            customBackgroundImage: document.getElementById('customBackgroundImage'),
            customBackgroundVideo: document.getElementById('customBackgroundVideo'),
            
            // Developer Mode
            devMode: document.getElementById('devMode'),
            closeDevMode: document.getElementById('closeDevMode'),
            devTabs: document.querySelectorAll('.dev-tab'),
            devTabContents: document.querySelectorAll('.dev-tab-content'),
            
            // Dev - Videos
            videoUrl: document.getElementById('videoUrl'),
            addVideoBtn: document.getElementById('addVideoBtn'),
            videosList: document.getElementById('videosList'),
            
            // Dev - Games
            gameName: document.getElementById('gameName'),
            gameLink: document.getElementById('gameLink'),
            gameImage: document.getElementById('gameImage'),
            addGameBtn: document.getElementById('addGameBtn'),
            gamesList: document.getElementById('gamesList'),
            
            // Dev - Clouds
            cloudName: document.getElementById('cloudName'),
            cloudLink: document.getElementById('cloudLink'),
            cloudImage: document.getElementById('cloudImage'),
            addCloudBtn: document.getElementById('addCloudBtn'),
            cloudsList: document.getElementById('cloudsList'),
            
            // Dev - Groups
            groupName: document.getElementById('groupName'),
            groupLink: document.getElementById('groupLink'),
            groupImage: document.getElementById('groupImage'),
            addGroupBtn: document.getElementById('addGroupBtn'),
            groupsList: document.getElementById('groupsList'),
            
            // Dev - Popup
            popupAvatarInput: document.getElementById('popupAvatarInput'),
            popupLink: document.getElementById('popupLink'),
            groupLink: document.getElementById('groupLink'),
            savePopupBtn: document.getElementById('savePopupBtn'),
            
            // Dev - Import/Export
            exportDataBtn: document.getElementById('exportDataBtn'),
            importDataInput: document.getElementById('importDataInput'),
            importDataBtn: document.getElementById('importDataBtn'),
            
            // Dev Login
            devLogin: document.getElementById('devLogin'),
            devPassword: document.getElementById('devPassword'),
            rememberDev: document.getElementById('rememberDev'),
            confirmDevLogin: document.getElementById('confirmDevLogin'),
            cancelDevLogin: document.getElementById('cancelDevLogin')
        };

        // Default avatar URL
        const DEFAULT_AVATAR_URL = "https://cdn2.fptshop.com.vn/small/avatar_trang_1_cd729c335b.jpg";

        // Like/Dislike cooldown time (10 minutes in milliseconds)
        const VOTE_COOLDOWN = 10 * 60 * 1000;

        // Music tracks
        const MUSIC_TRACKS = {
            track1: {
                url: "https://files.catbox.moe/ykzx20.mp3",
                name: "Cause I Love You",
                image: "https://files.catbox.moe/7795se.jpg"
            },
            track2: {
                url: "https://files.catbox.moe/5i3ird.mp3",
                name: "Th·∫ø Gian T√¨nh",
                image: "https://files.catbox.moe/oy40lw.jpg"
            },
            track3: {
                url: "https://files.catbox.moe/uhkz17.mp3",
                name: "T·ªôi Cho C√¥ G√°i ƒê√≥",
                image: "https://files.catbox.moe/8za3dh.jpg"
            }
        };

        // Daily login rewards
        const DAILY_REWARDS = {
            0: 20, // Monday
            1: 35, // Tuesday
            2: 55, // Wednesday
            3: 72, // Thursday
            4: 89, // Friday
            5: 100, // Saturday
            6: 125  // Sunday
        };

        // Cloud purchase options
        const CLOUD_PURCHASE_OPTIONS = [
            { duration: 6, price: 50 },
            { duration: 12, price: 150 },
            { duration: 24, price: 299 },
            { duration: 'infinite', price: 999 }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            checkAuthState();
            updateCoinsDisplay();
            setupDailyLogin();
            setupBackgroundRunner();
            setupCustomBackground();
        });

        function initializeApp() {
            // Apply theme
            applyTheme(appState.theme);
            
            // Check if welcome popup should be shown
            checkWelcomePopup();
            
            // Initialize music
            elements.backgroundMusic.volume = appState.music.volume;
            
            // Check for active cloud sessions
            checkActiveCloudSessions();
            
            // Setup music list
            setupMusicList();
            
            // Setup auto next button
            elements.autoNextBtn.classList.toggle('active', appState.music.autoNext);
        }

        function setupEventListeners() {
            // Login events
            elements.loginBtn.addEventListener('click', handleLogin);
            elements.registerBtn.addEventListener('click', showRegistrationForm);
            elements.guestBtn.addEventListener('click', handleGuestLogin);
            
            // Registration events
            elements.createAccountBtn.addEventListener('click', handleRegister);
            elements.backToLoginBtn.addEventListener('click', hideRegistrationForm);
            
            // Navigation events
            elements.navBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    switchPage(e.currentTarget.dataset.page);
                });
            });
            
            elements.logoutBtn.addEventListener('click', showLogoutConfirm);
            elements.confirmLogoutBtn.addEventListener('click', handleLogout);
            elements.cancelLogoutBtn.addEventListener('click', () => {
                hidePopup(elements.logoutConfirmPopup);
            });
            
            // Settings events
            elements.themeSwitch.addEventListener('change', toggleTheme);
            elements.backgroundRunner.addEventListener('change', toggleBackgroundRunner);
            elements.backgroundSettingsBtn.addEventListener('click', showBackgroundSettings);
            elements.devModeBtn.addEventListener('click', openDevLogin);
            elements.avatarUpload.addEventListener('change', handleAvatarUpload);
            
            // Search events
            elements.downloadSearchBtn.addEventListener('click', () => searchGames(elements.downloadSearch.value));
            elements.downloadSearch.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchGames(elements.downloadSearch.value);
            });
            
            elements.cloudSearchBtn.addEventListener('click', () => searchClouds(elements.cloudSearch.value));
            elements.cloudSearch.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchClouds(elements.cloudSearch.value);
            });
            
            // Social links events
            elements.youtubeLink.addEventListener('click', () => {
                window.open('https://youtube.com', '_blank');
            });
            
            elements.zaloLink.addEventListener('click', () => {
                window.open('https://zalo.me', '_blank');
            });
            
            elements.facebookLink.addEventListener('click', () => {
                window.open('https://facebook.com', '_blank');
            });
            
            // Daily login events
            elements.claimCodeBtn.addEventListener('click', claimCode);
            
            // Background runner events
            elements.backgroundRunnerBtn.addEventListener('click', toggleBackgroundRunnerBtn);
            
            // Zalo button events
            elements.zaloButton.addEventListener('click', showZaloGroupPopup);
            elements.confirmZaloBtn.addEventListener('click', () => {
                window.open('https://zalo.me/g/yourgroup', '_blank');
                hidePopup(elements.zaloGroupPopup);
            });
            elements.cancelZaloBtn.addEventListener('click', () => {
                hidePopup(elements.zaloGroupPopup);
            });
            
            // Name edit events
            elements.editNameBtn.addEventListener('click', showNameEditPopup);
            elements.editNameBtn2.addEventListener('click', showNameEditPopup);
            elements.saveNameBtn.addEventListener('click', saveName);
            elements.cancelNameBtn.addEventListener('click', hideNameEditPopup);
            
            // Music events
            elements.musicToggleBtn.addEventListener('click', toggleMusicPlayer);
            elements.closeMusicBtn.addEventListener('click', hideMusicPlayer);
            elements.toggleMusicList.addEventListener('click', toggleMusicList);
            elements.musicSearchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchMusic(elements.musicSearchInput.value);
            });
            elements.rewindBtn.addEventListener('click', rewindMusic);
            elements.playPauseBtn.addEventListener('click', togglePlayPause);
            elements.forwardBtn.addEventListener('click', forwardMusic);
            elements.autoNextBtn.addEventListener('click', toggleAutoNext);
            elements.volumeBtn.addEventListener('click', toggleMute);
            
            // Welcome popup events
            elements.notJoinedBtn.addEventListener('click', () => {
                window.open('#', '_blank');
                hideWelcomePopup();
            });
            
            elements.alreadyJoinedBtn.addEventListener('click', hideWelcomePopup);
            
            // Game detail popup events
            elements.downloadGameBtn.addEventListener('click', downloadCurrentGame);
            elements.cancelDownloadBtn.addEventListener('click', () => {
                hidePopup(elements.gameDetailPopup);
            });
            
            // Cloud purchase events
            elements.confirmPurchaseBtn.addEventListener('click', confirmCloudPurchase);
            elements.cancelPurchaseBtn.addEventListener('click', () => {
                hidePopup(elements.cloudPurchasePopup);
            });
            
            // Cloud viewer events
            elements.closeCloud.addEventListener('click', closeCloud);
            
            // Background settings events
            elements.applyBackgroundBtn.addEventListener('click', applyBackground);
            elements.resetBackgroundBtn.addEventListener('click', resetBackground);
            elements.cancelBackgroundBtn.addEventListener('click', () => {
                hidePopup(elements.backgroundSettingsPopup);
            });
            elements.backgroundSound.addEventListener('change', toggleBackgroundSound);
            
            // Setup drag and drop for background
            setupBackgroundDragDrop();
            
            // Developer mode events
            elements.closeDevMode.addEventListener('click', () => {
                hidePopup(elements.devMode);
            });
            
            // Dev tab events
            elements.devTabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    switchDevTab(e.target.dataset.tab);
                });
            });
            
            // Dev content management events
            elements.addVideoBtn.addEventListener('click', addVideo);
            elements.addGameBtn.addEventListener('click', addGame);
            elements.addCloudBtn.addEventListener('click', addCloud);
            elements.addGroupBtn.addEventListener('click', addGroup);
            elements.savePopupBtn.addEventListener('click', savePopupSettings);
            
            // Import/Export events
            elements.exportDataBtn.addEventListener('click', exportData);
            elements.importDataBtn.addEventListener('click', importData);
            
            // Dev login events
            elements.confirmDevLogin.addEventListener('click', confirmDevLogin);
            elements.cancelDevLogin.addEventListener('click', () => {
                hidePopup(elements.devLogin);
            });
            
            // Music ended event
            elements.backgroundMusic.addEventListener('ended', handleMusicEnded);
        }

        // Registration form functions
        function showRegistrationForm() {
            elements.registrationForm.classList.add('active');
        }

        function hideRegistrationForm() {
            elements.registrationForm.classList.remove('active');
        }

        // Authentication
        function checkAuthState() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                appState.currentUser = JSON.parse(savedUser);
                completeLogin();
            }
        }

        async function handleLogin() {
            const username = elements.username.value.trim();
            const password = elements.password.value;
            
            if (!username || !password) {
                alert('Vui l√≤ng nh·∫≠p t√™n ƒëƒÉng nh·∫≠p v√† m·∫≠t kh·∫©u');
                return;
            }
            
            // Simple authentication - in a real app, this would be more secure
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[username] && users[username].password === password) {
                appState.currentUser = users[username];
                localStorage.setItem('currentUser', JSON.stringify(appState.currentUser));
                completeLogin();
            } else {
                alert('T√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng');
            }
        }

        async function handleRegister() {
            const username = elements.regUsername.value.trim();
            const password = elements.regPassword.value;
            const confirmPass = elements.confirmPassword.value;
            const gender = document.querySelector('input[name="gender"]:checked')?.value;
            
            if (!username || !password || !confirmPass) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin');
                return;
            }
            
            if (password !== confirmPass) {
                alert('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp');
                return;
            }
            
            if (!gender) {
                alert('Vui l√≤ng ch·ªçn gi·ªõi t√≠nh');
                return;
            }
            
            try {
                // Get existing users
                const users = JSON.parse(localStorage.getItem('users') || '{}');
                
                // Check if username already exists
                if (users[username]) {
                    alert('T√™n ƒëƒÉng nh·∫≠p ƒë√£ t·ªìn t·∫°i');
                    return;
                }
                
                // Create new user
                const newUser = {
                    username: username,
                    password: password, // In a real app, this should be hashed
                    gender: gender,
                    diamonds: 100,
                    avatar: DEFAULT_AVATAR_URL,
                    createdAt: Date.now(),
                    votes: {}
                };
                
                // Save user
                users[username] = newUser;
                localStorage.setItem('users', JSON.stringify(users));
                
                // Set as current user
                appState.currentUser = newUser;
                localStorage.setItem('currentUser', JSON.stringify(appState.currentUser));
                
                // Add 50 coins for new user
                addCoins(50);
                alert('ƒêƒÉng k√Ω th√†nh c√¥ng! B·∫°n ƒë√£ ƒë∆∞·ª£c t·∫∑ng 50 xu!');
                
                console.log('ƒêƒÉng k√Ω th√†nh c√¥ng:', newUser);
                hideRegistrationForm();
                completeLogin();
            } catch (error) {
                console.error('L·ªói ƒëƒÉng k√Ω:', error);
                alert('ƒêƒÉng k√Ω th·∫•t b·∫°i: ' + error.message);
            }
        }

        function handleGuestLogin() {
            appState.isGuest = true;
            appState.currentUser = {
                username: 'Kh√°ch',
                diamonds: 0,
                avatar: DEFAULT_AVATAR_URL,
                votes: {}
            };
            
            completeLogin();
        }

        function completeLogin() {
            elements.loginScreen.classList.remove('active');
            elements.mainApp.classList.add('active');
            
            updateUserDisplay();
            updateCoinsDisplay();
            loadGames();
            loadClouds();
            loadGroups();
            loadZaloGroups();
            
            // Show welcome popup if needed
            setTimeout(() => {
                checkWelcomePopup();
            }, 500);
        }

        function showLogoutConfirm() {
            showPopup(elements.logoutConfirmPopup);
        }

        function handleLogout() {
            appState.isLoggedIn = false;
            appState.isGuest = false;
            appState.currentUser = null;
            
            localStorage.removeItem('currentUser');
            
            elements.mainApp.classList.remove('active');
            elements.loginScreen.classList.add('active');
            
            // Clear login form
            elements.username.value = '';
            elements.password.value = '';
            
            hidePopup(elements.logoutConfirmPopup);
        }

        function updateUserDisplay() {
            if (appState.currentUser) {
                elements.userDisplay.textContent = appState.currentUser.username;
                elements.accountName.textContent = appState.currentUser.username;
                elements.accountDiamonds.textContent = appState.currentUser.diamonds + ' Kim c∆∞∆°ng';
                
                // Set avatar - s·ª≠ d·ª•ng avatar m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng c√≥
                elements.accountAvatar.src = appState.currentUser.avatar || DEFAULT_AVATAR_URL;
            }
        }

        // Coins management
        function updateCoinsDisplay() {
            elements.coinsDisplay.textContent = `üí∞ ${appState.coins}`;
        }

        function addCoins(amount) {
            appState.coins += amount;
            localStorage.setItem('coins', appState.coins);
            updateCoinsDisplay();
        }

        function spendCoins(amount) {
            if (appState.coins >= amount) {
                appState.coins -= amount;
                localStorage.setItem('coins', appState.coins);
                updateCoinsDisplay();
                return true;
            }
            return false;
        }

        // Daily login system
        function setupDailyLogin() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Sunday, 1 = Monday, etc.
            
            // Create day items
            elements.dailyCalendar.innerHTML = '';
            
            for (let i = 0; i < 7; i++) {
                const dayItem = document.createElement('div');
                dayItem.className = 'day-item';
                
                // Check if this day is today
                if (i === dayOfWeek) {
                    dayItem.classList.add('active');
                    
                    // Check if already claimed today
                    const lastClaimed = appState.dailyLogin.lastClaimed;
                    if (lastClaimed) {
                        const lastClaimedDate = new Date(lastClaimed);
                        if (lastClaimedDate.toDateString() === today.toDateString()) {
                            dayItem.classList.add('claimed');
                        }
                    }
                }
                
                dayItem.innerHTML = `
                    <div class="day-name">${getDayName(i)}</div>
                    <div class="day-coins">${DAILY_REWARDS[i]} xu</div>
                `;
                
                // Add click event to claim reward
                if (i === dayOfWeek) {
                    dayItem.addEventListener('click', claimDailyReward);
                }
                
                elements.dailyCalendar.appendChild(dayItem);
            }
        }

        function getDayName(dayIndex) {
            const days = ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'];
            return days[dayIndex];
        }

        function claimDailyReward() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            
            // Check if already claimed today
            const lastClaimed = appState.dailyLogin.lastClaimed;
            if (lastClaimed) {
                const lastClaimedDate = new Date(lastClaimed);
                if (lastClaimedDate.toDateString() === today.toDateString()) {
                    alert('B·∫°n ƒë√£ nh·∫≠n th∆∞·ªüng h√¥m nay r·ªìi!');
                    return;
                }
                
                // Check if consecutive day
                const yesterday = new Date(today);
                yesterday.setDate(yesterday.getDate() - 1);
                if (lastClaimedDate.toDateString() === yesterday.toDateString()) {
                    appState.dailyLogin.streak++;
                } else {
                    appState.dailyLogin.streak = 1;
                }
            } else {
                appState.dailyLogin.streak = 1;
            }
            
            // Update last claimed
            appState.dailyLogin.lastClaimed = today.toISOString();
            localStorage.setItem('dailyLogin', JSON.stringify(appState.dailyLogin));
            
            // Add coins
            const reward = DAILY_REWARDS[dayOfWeek];
            addCoins(reward);
            
            // Update UI
            setupDailyLogin();
            
            alert(`B·∫°n ƒë√£ nh·∫≠n ${reward} xu! Chu·ªói ƒëƒÉng nh·∫≠p: ${appState.dailyLogin.streak} ng√†y`);
        }

        function claimCode() {
            const code = elements.codeInput.value.trim();
            
            if (!code) {
                alert('Vui l√≤ng nh·∫≠p m√£ code');
                return;
            }
            
            if (code === 'Tuann') {
                addCoins(99999);
                alert('B·∫°n ƒë√£ nh·∫≠n 99999 xu!');
                elements.codeInput.value = '';
            } else {
                alert('M√£ code kh√¥ng h·ª£p l·ªá');
            }
        }

        // Background runner
        function setupBackgroundRunner() {
            elements.backgroundRunner.checked = appState.backgroundRunner;
            
            if (appState.backgroundRunner) {
                document.addEventListener('visibilitychange', handleVisibilityChange);
            }
        }

        function toggleBackgroundRunner() {
            appState.backgroundRunner = elements.backgroundRunner.checked;
            localStorage.setItem('backgroundRunner', appState.backgroundRunner);
            
            if (appState.backgroundRunner) {
                document.addEventListener('visibilitychange', handleVisibilityChange);
                showNotification('ƒê√£ b·∫≠t ch·∫°y n·ªÅn ·ª©ng d·ª•ng th√†nh c√¥ng');
            } else {
                document.removeEventListener('visibilitychange', handleVisibilityChange);
                showNotification('ƒê√£ t·∫Øt ch·∫°y n·ªÅn ·ª©ng d·ª•ng th√†nh c√¥ng');
            }
        }

        function toggleBackgroundRunnerBtn() {
            appState.backgroundRunner = !appState.backgroundRunner;
            localStorage.setItem('backgroundRunner', appState.backgroundRunner);
            
            if (appState.backgroundRunner) {
                document.addEventListener('visibilitychange', handleVisibilityChange);
                showNotification('ƒê√£ b·∫≠t ch·∫°y n·ªÅn ·ª©ng d·ª•ng th√†nh c√¥ng');
            } else {
                document.removeEventListener('visibilitychange', handleVisibilityChange);
                showNotification('ƒê√£ t·∫Øt ch·∫°y n·ªÅn ·ª©ng d·ª•ng th√†nh c√¥ng');
            }
            
            // Update the checkbox in settings
            elements.backgroundRunner.checked = appState.backgroundRunner;
        }

        function handleVisibilityChange() {
            if (document.hidden && appState.backgroundRunner) {
                // App is running in background
                console.log('App is running in background');
            }
        }

        // Avatar upload function with drag and drop
        async function handleAvatarUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!appState.currentUser || appState.isGuest) {
                alert('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ thay ƒë·ªïi avatar');
                return;
            }
            
            try {
                // Convert image to base64 for localStorage
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    
                    // Update user data
                    appState.currentUser.avatar = imageData;
                    
                    // Update localStorage
                    if (!appState.isGuest) {
                        const users = JSON.parse(localStorage.getItem('users') || '{}');
                        users[appState.currentUser.username].avatar = imageData;
                        localStorage.setItem('users', JSON.stringify(users));
                        localStorage.setItem('currentUser', JSON.stringify(appState.currentUser));
                    }
                    
                    // Update UI
                    elements.accountAvatar.src = imageData;
                    
                    alert('Avatar ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng!');
                };
                
                reader.readAsDataURL(file);
            } catch (error) {
                console.error('L·ªói upload avatar:', error);
                alert('L·ªói upload avatar: ' + error.message);
            }
        }

        // Name edit functions
        function showNameEditPopup() {
            elements.newNameInput.value = appState.currentUser.username || '';
            showPopup(elements.nameEditPopup);
        }

        function hideNameEditPopup() {
            hidePopup(elements.nameEditPopup);
        }

        async function saveName() {
            const newName = elements.newNameInput.value.trim();
            
            if (!newName) {
                alert('Vui l√≤ng nh·∫≠p t√™n m·ªõi');
                return;
            }
            
            if (!appState.currentUser || appState.isGuest) {
                alert('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ thay ƒë·ªïi t√™n');
                return;
            }
            
            try {
                // Update user data
                appState.currentUser.username = newName;
                
                // Update localStorage
                if (!appState.isGuest) {
                    const users = JSON.parse(localStorage.getItem('users') || '{}');
                    // Remove old user entry and create new one
                    delete users[appState.currentUser.oldUsername];
                    users[newName] = appState.currentUser;
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('currentUser', JSON.stringify(appState.currentUser));
                }
                
                // Update UI
                updateUserDisplay();
                
                hideNameEditPopup();
                alert('T√™n ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng!');
            } catch (error) {
                console.error('L·ªói c·∫≠p nh·∫≠t t√™n:', error);
                alert('L·ªói c·∫≠p nh·∫≠t t√™n: ' + error.message);
            }
        }

        // Music functions
        function toggleMusicPlayer() {
            elements.musicPlayer.classList.toggle('active');
        }

        function hideMusicPlayer() {
            elements.musicPlayer.classList.remove('active');
        }

        function setupMusicList() {
            elements.musicList.innerHTML = '';
            
            for (const trackId in MUSIC_TRACKS) {
                const track = MUSIC_TRACKS[trackId];
                const musicItem = document.createElement('div');
                musicItem.className = 'music-item';
                musicItem.textContent = track.name;
                musicItem.dataset.trackId = trackId;
                
                musicItem.addEventListener('click', () => {
                    playMusic(trackId);
                    document.querySelectorAll('.music-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    musicItem.classList.add('active');
                });
                
                elements.musicList.appendChild(musicItem);
            }
        }

        function toggleMusicList() {
            elements.musicList.classList.toggle('active');
        }

        function searchMusic(query) {
            const filteredTracks = {};
            
            for (const trackId in MUSIC_TRACKS) {
                const track = MUSIC_TRACKS[trackId];
                if (track.name.toLowerCase().includes(query.toLowerCase())) {
                    filteredTracks[trackId] = track;
                }
            }
            
            // Update music list with filtered results
            elements.musicList.innerHTML = '';
            
            for (const trackId in filteredTracks) {
                const track = filteredTracks[trackId];
                const musicItem = document.createElement('div');
                musicItem.className = 'music-item';
                musicItem.textContent = track.name;
                musicItem.dataset.trackId = trackId;
                
                musicItem.addEventListener('click', () => {
                    playMusic(trackId);
                    document.querySelectorAll('.music-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    musicItem.classList.add('active');
                });
                
                elements.musicList.appendChild(musicItem);
            }
            
            // Show music list if there are results
            if (Object.keys(filteredTracks).length > 0) {
                elements.musicList.classList.add('active');
            }
        }

        function playMusic(trackId) {
            const track = MUSIC_TRACKS[trackId];
            if (track) {
                elements.backgroundMusic.src = track.url;
                elements.backgroundMusic.play();
                appState.music.isPlaying = true;
                appState.music.currentTrack = trackId;
                
                // Update album art
                elements.musicAlbumArt.src = track.image;
                
                // Update play/pause button
                elements.playPauseBtn.textContent = '‚è∏Ô∏è';
                
                // Update music title
                elements.musicTitle.textContent = track.name;
                elements.musicTitle.classList.remove('paused');
            }
        }

        function togglePlayPause() {
            if (appState.music.isPlaying) {
                elements.backgroundMusic.pause();
                appState.music.isPlaying = false;
                elements.playPauseBtn.textContent = '‚ñ∂Ô∏è';
                elements.musicTitle.classList.add('paused');
            } else {
                elements.backgroundMusic.play();
                appState.music.isPlaying = true;
                elements.playPauseBtn.textContent = '‚è∏Ô∏è';
                elements.musicTitle.classList.remove('paused');
            }
        }

        function rewindMusic() {
            elements.backgroundMusic.currentTime = Math.max(0, elements.backgroundMusic.currentTime - 10);
        }

        function forwardMusic() {
            elements.backgroundMusic.currentTime = Math.min(elements.backgroundMusic.duration, elements.backgroundMusic.currentTime + 10);
        }

        function toggleAutoNext() {
            appState.music.autoNext = !appState.music.autoNext;
            elements.autoNextBtn.classList.toggle('active', appState.music.autoNext);
        }

        function toggleMute() {
            appState.music.isMuted = !appState.music.isMuted;
            elements.backgroundMusic.muted = appState.music.isMuted;
            elements.volumeBtn.textContent = appState.music.isMuted ? 'üîá' : 'üîä';
        }

        function handleMusicEnded() {
            if (appState.music.autoNext && appState.music.currentTrack) {
                // Get current track index
                const trackIds = Object.keys(MUSIC_TRACKS);
                const currentIndex = trackIds.indexOf(appState.music.currentTrack);
                
                // Play next track or loop back to first
                const nextIndex = (currentIndex + 1) % trackIds.length;
                playMusic(trackIds[nextIndex]);
                
                // Update active music item
                document.querySelectorAll('.music-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`.music-item[data-track-id="${trackIds[nextIndex]}"]`).classList.add('active');
            }
        }

        // Navigation
        function switchPage(page) {
            // Update active nav button
            elements.navBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.page === page);
            });
            
            // Update active page
            elements.downloadPage.classList.toggle('active', page === 'download');
            elements.cloudPage.classList.toggle('active', page === 'cloud');
            elements.groupsPage.classList.toggle('active', page === 'groups');
            elements.settingsPage.classList.toggle('active', page === 'settings');
            
            appState.currentPage = page;
        }

        // Theme management
        function toggleTheme() {
            const newTheme = elements.themeSwitch.checked ? 'dark' : 'light';
            applyTheme(newTheme);
            
            // Save theme to localStorage
            localStorage.setItem('theme', newTheme);
            
            // Show notification
            showNotification(`ƒê√£ chuy·ªÉn sang ch·∫ø ƒë·ªô ${newTheme === 'dark' ? 't·ªëi' : 's√°ng'} th√†nh c√¥ng`);
        }

        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            elements.themeSwitch.checked = theme === 'dark';
        }

        // Notification function
        function showNotification(message) {
            elements.notificationText.textContent = message;
            elements.notification.classList.add('show');
            
            setTimeout(() => {
                elements.notification.classList.remove('show');
            }, 3000);
        }

        // Zalo group popup
        function showZaloGroupPopup() {
            showPopup(elements.zaloGroupPopup);
        }

        // Welcome popup
        function checkWelcomePopup() {
            if (!appState.welcomePopup.show) return;
            
            const now = Date.now();
            if (appState.welcomePopup.disabledUntil && now < appState.welcomePopup.disabledUntil) {
                return;
            }
            
            showPopup(elements.welcomePopup);
        }

        function hideWelcomePopup() {
            if (elements.disableNotification.checked) {
                const twoHours = 2 * 60 * 60 * 1000; // 2 hours in milliseconds
                appState.welcomePopup.disabledUntil = Date.now() + twoHours;
            }
            
            hidePopup(elements.welcomePopup);
            appState.welcomePopup.show = false;
        }

        // Games management
        async function loadGames() {
            try {
                // Try to load from localStorage first
                let gamesData = JSON.parse(localStorage.getItem('games') || '[]');
                
                // If no games in localStorage, try to load from download.json
                if (gamesData.length === 0) {
                    try {
                        const response = await fetch('download.json');
                        if (response.ok) {
                            gamesData = await response.json();
                            // Save to localStorage for future use
                            localStorage.setItem('games', JSON.stringify(gamesData));
                        }
                    } catch (error) {
                        console.error('L·ªói t·∫£i download.json:', error);
                    }
                }
                
                renderGames(gamesData);
            } catch (error) {
                console.error('L·ªói t·∫£i games:', error);
                renderGames([]);
            }
        }

        function renderGames(games) {
            elements.gamesGrid.innerHTML = '';
            
            if (games.length === 0) {
                elements.gamesGrid.innerHTML = `
                    <div class="empty-state">
                        <p>Ch∆∞a c√≥ game n√†o</p>
                    </div>
                `;
                return;
            }
            
            games.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'game-card';
                gameCard.innerHTML = `
                    <img src="${game.image}" alt="${game.name}">
                    <div class="game-info">
                        <h3>${game.name}</h3>
                    </div>
                `;
                
                gameCard.addEventListener('click', () => {
                    showGameDetail(game);
                });
                
                elements.gamesGrid.appendChild(gameCard);
            });
        }

        function searchGames(query) {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            if (!query) {
                renderGames(games);
                elements.downloadSearchResults.textContent = '';
                return;
            }
            
            const filteredGames = games.filter(game => 
                game.name.toLowerCase().includes(query.toLowerCase())
            );
            
            renderGames(filteredGames);
            
            // Show search results info
            if (filteredGames.length > 0) {
                elements.downloadSearchResults.textContent = `T√¨m th·∫•y ${filteredGames.length} k·∫øt qu·∫£ cho "${query}"`;
            } else {
                elements.downloadSearchResults.textContent = `Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o cho "${query}"`;
            }
        }

        function showGameDetail(game) {
            elements.gameDetailImage.src = game.image;
            elements.gameDetailTitle.textContent = game.name;
            elements.downloadGameBtn.dataset.url = game.downloadUrl;
            
            showPopup(elements.gameDetailPopup);
        }

        function downloadCurrentGame() {
            const url = elements.downloadGameBtn.dataset.url;
            window.open(url, '_blank');
            hidePopup(elements.gameDetailPopup);
        }

        // Cloud management
        async function loadClouds() {
            try {
                // Try to load from localStorage first
                let cloudsData = JSON.parse(localStorage.getItem('clouds') || '[]');
                
                // If no clouds in localStorage, try to load from cloud.json
                if (cloudsData.length === 0) {
                    try {
                        const response = await fetch('cloud.json');
                        if (response.ok) {
                            cloudsData = await response.json();
                            // Save to localStorage for future use
                            localStorage.setItem('clouds', JSON.stringify(cloudsData));
                        }
                    } catch (error) {
                        console.error('L·ªói t·∫£i cloud.json:', error);
                    }
                }
                
                renderClouds(cloudsData);
            } catch (error) {
                console.error('L·ªói t·∫£i clouds:', error);
                renderClouds([]);
            }
        }

        function renderClouds(clouds) {
            elements.cloudsGrid.innerHTML = '';
            
            if (clouds.length === 0) {
                elements.cloudsGrid.innerHTML = `
                    <div class="empty-state">
                        <p>Ch∆∞a c√≥ cloud n√†o</p>
                    </div>
                `;
                return;
            }
            
            clouds.forEach(cloud => {
                const cloudCard = document.createElement('div');
                cloudCard.className = 'cloud-card';
                
                // Ki·ªÉm tra tr·∫°ng th√°i vote c·ªßa ng∆∞·ªùi d√πng
                const userVote = getUserVoteForCloud(cloud.id);
                const isLiked = userVote === 'like';
                const isDisliked = userVote === 'dislike';
                const canVote = canUserVote(cloud.id);
                
                cloudCard.innerHTML = `
                    <img src="${cloud.image}" alt="${cloud.name}">
                    <div class="cloud-info">
                        <h3>${cloud.name}</h3>
                        <div class="cloud-stats">
                            <button class="like-btn ${isLiked ? 'active' : ''} ${!canVote ? 'disabled' : ''}" 
                                    data-id="${cloud.id}" 
                                    ${!canVote ? 'disabled' : ''}>
                                üëç ${cloud.likes || 0}
                            </button>
                            <button class="dislike-btn ${isDisliked ? 'active' : ''} ${!canVote ? 'disabled' : ''}" 
                                    data-id="${cloud.id}" 
                                    ${!canVote ? 'disabled' : ''}>
                                üëé ${cloud.dislikes || 0}
                            </button>
                        </div>
                        ${!canVote ? '<div class="vote-cooldown">C√≥ th·ªÉ vote l·∫°i sau 10 ph√∫t</div>' : ''}
                    </div>
                `;
                
                // Open cloud viewer on click
                cloudCard.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('like-btn') && !e.target.classList.contains('dislike-btn') && !e.target.classList.contains('vote-cooldown')) {
                        openCloudPurchase(cloud);
                    }
                });
                
                // Like/dislike buttons
                const likeBtn = cloudCard.querySelector('.like-btn');
                const dislikeBtn = cloudCard.querySelector('.dislike-btn');
                
                likeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (canVote) {
                        likeCloud(cloud.id);
                    }
                });
                
                dislikeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (canVote) {
                        dislikeCloud(cloud.id);
                    }
                });
                
                elements.cloudsGrid.appendChild(cloudCard);
            });
        }

        function searchClouds(query) {
            const clouds = JSON.parse(localStorage.getItem('clouds') || '[]');
            if (!query) {
                renderClouds(clouds);
                elements.cloudSearchResults.textContent = '';
                return;
            }
            
            const filteredClouds = clouds.filter(cloud => 
                cloud.name.toLowerCase().includes(query.toLowerCase())
            );
            
            renderClouds(filteredClouds);
            
            // Show search results info
            if (filteredClouds.length > 0) {
                elements.cloudSearchResults.textContent = `T√¨m th·∫•y ${filteredClouds.length} k·∫øt qu·∫£ cho "${query}"`;
            } else {
                elements.cloudSearchResults.textContent = `Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o cho "${query}"`;
            }
        }

        // Groups management
        async function loadGroups() {
            try {
                // Try to load from localStorage first
                let groupsData = JSON.parse(localStorage.getItem('groups') || '[]');
                
                // If no groups in localStorage, try to load from group.json
                if (groupsData.length === 0) {
                    try {
                        const response = await fetch('group.json');
                        if (response.ok) {
                            groupsData = await response.json();
                            // Save to localStorage for future use
                            localStorage.setItem('groups', JSON.stringify(groupsData));
                        }
                    } catch (error) {
                        console.error('L·ªói t·∫£i group.json:', error);
                    }
                }
                
                renderGroups(groupsData);
            } catch (error) {
                console.error('L·ªói t·∫£i groups:', error);
                renderGroups([]);
            }
        }

        function renderGroups(groups) {
            elements.groupsGrid.innerHTML = '';
            
            if (groups.length === 0) {
                elements.groupsGrid.innerHTML = `
                    <div class="empty-state">
                        <p>Ch∆∞a c√≥ group n√†o</p>
                    </div>
                `;
                return;
            }
            
            groups.forEach(group => {
                const groupCard = document.createElement('div');
                groupCard.className = 'group-card';
                groupCard.innerHTML = `
                    <img src="${group.image}" alt="${group.name}">
                    <div class="group-info">
                        <h3>${group.name}</h3>
                        <button class="btn-primary join-group-btn" data-link="${group.link}">Tham gia</button>
                    </div>
                `;
                
                const joinBtn = groupCard.querySelector('.join-group-btn');
                joinBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    window.open(group.link, '_blank');
                });
                
                elements.groupsGrid.appendChild(groupCard);
            });
        }

        // Zalo Groups in Settings
        async function loadZaloGroups() {
            try {
                // Try to load from localStorage first
                let zaloGroupsData = JSON.parse(localStorage.getItem('zaloGroups') || '[]');
                
                // If no groups in localStorage, try to load from settinggroupzalo.json
                if (zaloGroupsData.length === 0) {
                    try {
                        const response = await fetch('settinggroupzalo.json');
                        if (response.ok) {
                            zaloGroupsData = await response.json();
                            // Save to localStorage for future use
                            localStorage.setItem('zaloGroups', JSON.stringify(zaloGroupsData));
                        }
                    } catch (error) {
                        console.error('L·ªói t·∫£i settinggroupzalo.json:', error);
                    }
                }
                
                renderZaloGroups(zaloGroupsData);
            } catch (error) {
                console.error('L·ªói t·∫£i zalo groups:', error);
                renderZaloGroups([]);
            }
        }

        function renderZaloGroups(groups) {
            elements.zaloGroupsContainer.innerHTML = '';
            
            if (groups.length === 0) {
                elements.zaloGroupsContainer.innerHTML = `
                    <div class="empty-state">
                        <p>Ch∆∞a c√≥ nh√≥m Zalo n√†o</p>
                    </div>
                `;
                return;
            }
            
            groups.forEach(group => {
                const groupElement = document.createElement('div');
                groupElement.className = 'zalo-group';
                groupElement.innerHTML = `
                    <div class="group-avatar">
                        <img src="${group.image}" alt="${group.name}">
                    </div>
                    <div class="group-info">
                        <h4>${group.name}</h4>
                        <button class="btn-primary join-btn" data-link="${group.link}">Tham gia</button>
                    </div>
                `;
                
                const joinBtn = groupElement.querySelector('.join-btn');
                joinBtn.addEventListener('click', () => {
                    window.open(group.link, '_blank');
                });
                
                elements.zaloGroupsContainer.appendChild(groupElement);
            });
        }

        // Cloud purchase functions
        function openCloudPurchase(cloud) {
            // Check if user already has active purchase for this cloud
            const cloudPurchase = appState.purchasedClouds[cloud.id];
            if (cloudPurchase) {
                const now = Date.now();
                if (cloudPurchase.expiresAt === 'infinite' || now < cloudPurchase.expiresAt) {
                    // User has active purchase, open cloud directly
                    openCloud(cloud.name, cloud.url, cloud.id);
                    return;
                } else {
                    // Purchase expired, remove it
                    delete appState.purchasedClouds[cloud.id];
                    localStorage.setItem('purchasedClouds', JSON.stringify(appState.purchasedClouds));
                }
            }
            
            // Show purchase options
            elements.cloudPurchaseTitle.textContent = `Mua Cloud: ${cloud.name}`;
            elements.confirmPurchaseBtn.dataset.cloudId = cloud.id;
            elements.confirmPurchaseBtn.dataset.cloudName = cloud.name;
            elements.confirmPurchaseBtn.dataset.cloudUrl = cloud.url;
            
            // Reset purchase options selection
            document.querySelectorAll('.purchase-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            showPopup(elements.cloudPurchasePopup);
            
            // Add click events to purchase options
            document.querySelectorAll('.purchase-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.purchase-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
        }

        function confirmCloudPurchase() {
            const selectedOption = document.querySelector('.purchase-option.selected');
            if (!selectedOption) {
                alert('Vui l√≤ng ch·ªçn g√≥i th·ªùi gian s·ª≠ d·ª•ng');
                return;
            }
            
            const cloudId = elements.confirmPurchaseBtn.dataset.cloudId;
            const cloudName = elements.confirmPurchaseBtn.dataset.cloudName;
            const cloudUrl = elements.confirmPurchaseBtn.dataset.cloudUrl;
            const duration = selectedOption.dataset.duration;
            const price = parseInt(selectedOption.dataset.price);
            
            if (!spendCoins(price)) {
                alert('B·∫°n kh√¥ng ƒë·ªß xu ƒë·ªÉ mua g√≥i n√†y');
                return;
            }
            
            // Calculate expiration time
            let expiresAt;
            if (duration === 'infinite') {
                expiresAt = 'infinite';
            } else {
                const hours = parseInt(duration);
                expiresAt = Date.now() + (hours * 60 * 60 * 1000);
            }
            
            // Save purchase
            appState.purchasedClouds[cloudId] = {
                purchasedAt: Date.now(),
                expiresAt: expiresAt,
                duration: duration
            };
            localStorage.setItem('purchasedClouds', JSON.stringify(appState.purchasedClouds));
            
            // Open cloud
            openCloud(cloudName, cloudUrl, cloudId);
            
            hidePopup(elements.cloudPurchasePopup);
            alert(`B·∫°n ƒë√£ mua cloud ${cloudName} th√†nh c√¥ng!`);
        }

        // Vote management functions
        function getUserVoteForCloud(cloudId) {
            if (!appState.currentUser || !appState.currentUser.votes) {
                return null;
            }
            return appState.currentUser.votes[cloudId];
        }

        function canUserVote(cloudId) {
            if (!appState.currentUser || !appState.currentUser.votes) {
                return true;
            }
            
            const voteData = appState.currentUser.votes[cloudId];
            if (!voteData) {
                return true;
            }
            
            const now = Date.now();
            const lastVoteTime = voteData.timestamp;
            return (now - lastVoteTime) > VOTE_COOLDOWN;
        }

        async function likeCloud(cloudId) {
            if (!canUserVote(cloudId)) {
                alert('B·∫°n ph·∫£i ch·ªù 10 ph√∫t sau m·ªõi c√≥ th·ªÉ vote l·∫°i!');
                return;
            }
            
            try {
                const clouds = JSON.parse(localStorage.getItem('clouds') || '[]');
                const cloudIndex = clouds.findIndex(c => c.id === cloudId);
                
                if (cloudIndex !== -1) {
                    const cloud = clouds[cloudIndex];
                    const userVote = getUserVoteForCloud(cloudId);
                    let newLikes = cloud.likes || 0;
                    let newDislikes = cloud.dislikes || 0;
                    
                    // N·∫øu ƒë√£ dislike tr∆∞·ªõc ƒë√≥, b·ªè dislike
                    if (userVote === 'dislike') {
                        newDislikes = Math.max(0, newDislikes - 1);
                    }
                    
                    // N·∫øu ch∆∞a like th√¨ tƒÉng like, n·∫øu ƒë√£ like th√¨ b·ªè like
                    if (userVote === 'like') {
                        newLikes = Math.max(0, newLikes - 1);
                    } else {
                        newLikes += 1;
                    }
                    
                    clouds[cloudIndex].likes = newLikes;
                    clouds[cloudIndex].dislikes = newDislikes;
                    
                    localStorage.setItem('clouds', JSON.stringify(clouds));
                    
                    // Update user vote data
                    await updateUserVote(cloudId, userVote === 'like' ? null : 'like');
                    
                    loadClouds(); // Refresh the view
                }
            } catch (error) {
                console.error('L·ªói like cloud:', error);
                alert('L·ªói khi like: ' + error.message);
            }
        }

        async function dislikeCloud(cloudId) {
            if (!canUserVote(cloudId)) {
                alert('B·∫°n ph·∫£i ch·ªù 10 ph√∫t sau m·ªõi c√≥ th·ªÉ vote l·∫°i!');
                return;
            }
            
            try {
                const clouds = JSON.parse(localStorage.getItem('clouds') || '[]');
                const cloudIndex = clouds.findIndex(c => c.id === cloudId);
                
                if (cloudIndex !== -1) {
                    const cloud = clouds[cloudIndex];
                    const userVote = getUserVoteForCloud(cloudId);
                    let newLikes = cloud.likes || 0;
                    let newDislikes = cloud.dislikes || 0;
                    
                    // N·∫øu ƒë√£ like tr∆∞·ªõc ƒë√≥, b·ªè like
                    if (userVote === 'like') {
                        newLikes = Math.max(0, newLikes - 1);
                    }
                    
                    // N·∫øu ch∆∞a dislike th√¨ tƒÉng dislike, n·∫øu ƒë√£ dislike th√¨ b·ªè dislike
                    if (userVote === 'dislike') {
                        newDislikes = Math.max(0, newDislikes - 1);
                    } else {
                        newDislikes += 1;
                    }
                    
                    clouds[cloudIndex].likes = newLikes;
                    clouds[cloudIndex].dislikes = newDislikes;
                    
                    localStorage.setItem('clouds', JSON.stringify(clouds));
                    
                    // Update user vote data
                    await updateUserVote(cloudId, userVote === 'dislike' ? null : 'dislike');
                    
                    loadClouds(); // Refresh the view
                }
            } catch (error) {
                console.error('L·ªói dislike cloud:', error);
                alert('L·ªói khi dislike: ' + error.message);
            }
        }

        async function updateUserVote(cloudId, voteType) {
            if (!appState.currentUser || appState.isGuest) {
                return;
            }
            
            try {
                if (voteType === null) {
                    // Remove vote
                    delete appState.currentUser.votes[cloudId];
                } else {
                    // Add/update vote
                    appState.currentUser.votes[cloudId] = {
                        type: voteType,
                        timestamp: Date.now()
                    };
                }
                
                // Update localStorage
                if (!appState.isGuest) {
                    const users = JSON.parse(localStorage.getItem('users') || '{}');
                    users[appState.currentUser.username].votes = appState.currentUser.votes;
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('currentUser', JSON.stringify(appState.currentUser));
                }
            } catch (error) {
                console.error('L·ªói c·∫≠p nh·∫≠t vote:', error);
            }
        }

        // Cloud Viewer
        function openCloud(name, url, cloudId) {
            // Check if user has active purchase for this cloud
            const cloudPurchase = appState.purchasedClouds[cloudId];
            if (!cloudPurchase) {
                alert('B·∫°n ch∆∞a mua cloud n√†y!');
                return;
            }
            
            const now = Date.now();
            if (cloudPurchase.expiresAt !== 'infinite' && now >= cloudPurchase.expiresAt) {
                alert('Th·ªùi gian s·ª≠ d·ª•ng cloud c·ªßa b·∫°n ƒë√£ h·∫øt! Vui l√≤ng mua l·∫°i.');
                delete appState.purchasedClouds[cloudId];
                localStorage.setItem('purchasedClouds', JSON.stringify(appState.purchasedClouds));
                return;
            }
            
            elements.cloudViewerTitle.textContent = name;
            
            // Fix for cloud embed issues
            // Add sandbox attributes to iframe to prevent connection issues
            elements.cloudFrame.sandbox = "allow-scripts allow-same-origin allow-forms allow-popups";
            elements.cloudFrame.src = url;
            
            appState.cloudViewer.isOpen = true;
            appState.cloudViewer.currentCloud = { name, url, id: cloudId };
            
            elements.cloudViewer.classList.add('active');
        }

        function closeCloud() {
            appState.cloudViewer.isOpen = false;
            appState.cloudViewer.currentCloud = null;
            
            elements.cloudViewer.classList.remove('active');
            elements.cloudFrame.src = '';
        }

        function checkActiveCloudSessions() {
            // Check if any purchased clouds are still valid
            const now = Date.now();
            let hasActiveSession = false;
            
            for (const cloudId in appState.purchasedClouds) {
                const purchase = appState.purchasedClouds[cloudId];
                if (purchase.expiresAt === 'infinite' || now < purchase.expiresAt) {
                    hasActiveSession = true;
                    break;
                }
            }
            
            if (hasActiveSession) {
                // In a real app, you would restore the cloud session here
                console.log('Found active cloud sessions');
            }
        }

        // Custom Background Functions
        function setupCustomBackground() {
            if (appState.customBackground.type !== 'none') {
                applyCustomBackground();
            }
        }

        function showBackgroundSettings() {
            showPopup(elements.backgroundSettingsPopup);
            
            // Load current background settings
            elements.backgroundSound.checked = appState.customBackground.soundEnabled;
            
            // Clear preview
            elements.backgroundPreview.innerHTML = '';
        }

        function setupBackgroundDragDrop() {
            const dragDropArea = elements.backgroundDragDrop;
            
            // Prevent default drag behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dragDropArea.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            
            // Highlight drop area when item is dragged over it
            ['dragenter', 'dragover'].forEach(eventName => {
                dragDropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dragDropArea.addEventListener(eventName, unhighlight, false);
            });
            
            // Handle dropped files
            dragDropArea.addEventListener('drop', handleDrop, false);
            
            // Handle click to select file
            dragDropArea.addEventListener('click', () => {
                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = 'image/*,video/*';
                fileInput.multiple = false;
                fileInput.addEventListener('change', handleFileSelect);
                fileInput.click();
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            function highlight() {
                dragDropArea.classList.add('active');
            }
            
            function unhighlight() {
                dragDropArea.classList.remove('active');
            }
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }
            
            function handleFileSelect(e) {
                const files = e.target.files;
                handleFiles(files);
            }
            
            function handleFiles(files) {
                if (files.length > 0) {
                    const file = files[0];
                    const fileType = file.type.split('/')[0]; // 'image' or 'video'
                    const fileSize = file.size; // in bytes
                    
                    // Check file size for videos (max 50MB)
                    if (fileType === 'video' && fileSize > 50 * 1024 * 1024) {
                        alert('Video qu√° l·ªõn! Vui l√≤ng ch·ªçn video d∆∞·ªõi 50MB.');
                        return;
                    }
                    
                    // Create preview
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const dataUrl = e.target.result;
                        
                        if (fileType === 'image') {
                            elements.backgroundPreview.innerHTML = `<img src="${dataUrl}" alt="Background Preview">`;
                        } else if (fileType === 'video') {
                            elements.backgroundPreview.innerHTML = `<video src="${dataUrl}" controls></video>`;
                            // Auto-enable sound for videos
                            elements.backgroundSound.checked = true;
                        }
                        
                        // Store file data for later use
                        elements.backgroundPreview.dataset.fileType = fileType;
                        elements.backgroundPreview.dataset.fileData = dataUrl;
                    };
                    
                    if (fileType === 'image') {
                        reader.readAsDataURL(file);
                    } else if (fileType === 'video') {
                        reader.readAsDataURL(file);
                    }
                }
            }
        }

        function applyBackground() {
            const fileType = elements.backgroundPreview.dataset.fileType;
            const fileData = elements.backgroundPreview.dataset.fileData;
            
            if (!fileType || !fileData) {
                alert('Vui l√≤ng ch·ªçn ·∫£nh ho·∫∑c video ƒë·ªÉ l√†m h√¨nh n·ªÅn');
                return;
            }
            
            // Save background settings
            appState.customBackground = {
                type: fileType,
                data: fileData,
                soundEnabled: elements.backgroundSound.checked
            };
            
            localStorage.setItem('customBackground', JSON.stringify(appState.customBackground));
            
            // Apply the background
            applyCustomBackground();
            
            hidePopup(elements.backgroundSettingsPopup);
            showNotification('H√¨nh n·ªÅn ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh c√¥ng!');
        }

        function resetBackground() {
            appState.customBackground = {
                type: 'none',
                data: null,
                soundEnabled: false
            };
            
            localStorage.setItem('customBackground', JSON.stringify(appState.customBackground));
            
            // Remove custom background
            elements.customBackgroundImage.style.display = 'none';
            elements.customBackgroundVideo.style.display = 'none';
            elements.customBackgroundVideo.pause();
            
            hidePopup(elements.backgroundSettingsPopup);
            showNotification('ƒê√£ kh√¥i ph·ª•c h√¨nh n·ªÅn m·∫∑c ƒë·ªãnh!');
        }

        function applyCustomBackground() {
            const bg = appState.customBackground;
            
            if (bg.type === 'image' && bg.data) {
                elements.customBackgroundImage.src = bg.data;
                elements.customBackgroundImage.style.display = 'block';
                elements.customBackgroundVideo.style.display = 'none';
                elements.customBackgroundVideo.pause();
            } else if (bg.type === 'video' && bg.data) {
                elements.customBackgroundVideo.src = bg.data;
                elements.customBackgroundVideo.muted = !bg.soundEnabled;
                elements.customBackgroundVideo.style.display = 'block';
                elements.customBackgroundImage.style.display = 'none';
                
                // Play the video
                elements.customBackgroundVideo.play().catch(e => {
                    console.error('L·ªói ph√°t video:', e);
                });
            } else {
                elements.customBackgroundImage.style.display = 'none';
                elements.customBackgroundVideo.style.display = 'none';
                elements.customBackgroundVideo.pause();
            }
        }

        function toggleBackgroundSound() {
            if (appState.customBackground.type === 'video') {
                appState.customBackground.soundEnabled = elements.backgroundSound.checked;
                localStorage.setItem('customBackground', JSON.stringify(appState.customBackground));
                
                // Apply sound setting
                elements.customBackgroundVideo.muted = !appState.customBackground.soundEnabled;
            }
        }

        // Developer Mode
        function openDevLogin() {
            showPopup(elements.devLogin);
        }

        function confirmDevLogin() {
            const password = elements.devPassword.value;
            
            if (password === '09090909') {
                appState.devMode = true;
                hidePopup(elements.devLogin);
                showPopup(elements.devMode);
                
                // Load dev data
                loadDevData();
            } else {
                alert('M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng');
            }
        }

        function switchDevTab(tabName) {
            // Update active tab
            elements.devTabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabName);
            });
            
            // Update active content
            elements.devTabContents.forEach(content => {
                content.classList.toggle('active', content.id === `${tabName}Tab`);
            });
        }

        async function loadDevData() {
            // Load videos
            await loadVideosList();
            
            // Load games
            await loadGamesList();
            
            // Load clouds
            await loadCloudsList();
            
            // Load groups
            await loadGroupsList();
            
            // Load popup settings
            await loadPopupSettings();
        }

        // Dev - Videos management
        async function loadVideosList() {
            try {
                const videosData = JSON.parse(localStorage.getItem('videos') || '[]');
                renderVideosList(videosData);
            } catch (error) {
                console.error('L·ªói t·∫£i videos:', error);
            }
        }

        function renderVideosList(videos) {
            elements.videosList.innerHTML = '';
            
            videos.forEach(video => {
                const videoItem = document.createElement('div');
                videoItem.className = 'item';
                videoItem.innerHTML = `
                    <div class="item-info">
                        <h4>${video.title || 'Video'}</h4>
                        <p>${video.url}</p>
                    </div>
                    <div class="item-actions">
                        <button class="delete-btn" data-id="${video.id}">X√≥a</button>
                    </div>
                `;
                
                const deleteBtn = videoItem.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteVideo(video.id);
                });
                
                elements.videosList.appendChild(videoItem);
            });
        }

        async function addVideo() {
            const url = elements.videoUrl.value.trim();
            
            if (!url) {
                alert('Vui l√≤ng nh·∫≠p link YouTube');
                return;
            }
            
            try {
                const newVideo = {
                    id: Date.now(),
                    url,
                    title: `Video ${Date.now()}`
                };
                
                const videos = JSON.parse(localStorage.getItem('videos') || '[]');
                videos.push(newVideo);
                localStorage.setItem('videos', JSON.stringify(videos));
                
                renderVideosList(videos);
                
                elements.videoUrl.value = '';
            } catch (error) {
                console.error('L·ªói th√™m video:', error);
                alert('L·ªói th√™m video: ' + error.message);
            }
        }

        async function getVideos() {
            return JSON.parse(localStorage.getItem('videos') || '[]');
        }

        async function deleteVideo(videoId) {
            try {
                const videos = JSON.parse(localStorage.getItem('videos') || '[]');
                const filteredVideos = videos.filter(v => v.id !== videoId);
                localStorage.setItem('videos', JSON.stringify(filteredVideos));
                renderVideosList(filteredVideos);
            } catch (error) {
                console.error('L·ªói x√≥a video:', error);
                alert('L·ªói x√≥a video: ' + error.message);
            }
        }

        // Dev - Games management
        async function loadGamesList() {
            try {
                const gamesData = JSON.parse(localStorage.getItem('games') || '[]');
                renderGamesList(gamesData);
            } catch (error) {
                console.error('L·ªói t·∫£i games:', error);
            }
        }

        function renderGamesList(games) {
            elements.gamesList.innerHTML = '';
            
            games.forEach(game => {
                const gameItem = document.createElement('div');
                gameItem.className = 'item';
                gameItem.innerHTML = `
                    <img src="${game.image}" alt="${game.name}">
                    <div class="item-info">
                        <h4>${game.name}</h4>
                        <p>${game.downloadUrl}</p>
                    </div>
                    <div class="item-actions">
                        <button class="delete-btn" data-id="${game.id}">X√≥a</button>
                    </div>
                `;
                
                const deleteBtn = gameItem.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteGame(game.id);
                });
                
                elements.gamesList.appendChild(gameItem);
            });
        }

        async function addGame() {
            const name = elements.gameName.value.trim();
            const link = elements.gameLink.value.trim();
            const imageFile = elements.gameImage.files[0];
            
            if (!name || !link) {
                alert('Vui l√≤ng nh·∫≠p t√™n game v√† link download');
                return;
            }
            
            try {
                let imageSrc = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="200" viewBox="0 0 300 200"%3E%3Crect width="300" height="200" fill="%23006AFF"/%3E%3Ctext x="150" y="100" text-anchor="middle" fill="white" font-size="24"%3E' + encodeURIComponent(name) + '%3C/text%3E%3C/svg%3E';
                
                if (imageFile) {
                    // Convert image to base64 for localStorage
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageSrc = e.target.result;
                        completeAddGame(name, link, imageSrc);
                    };
                    reader.readAsDataURL(imageFile);
                } else {
                    completeAddGame(name, link, imageSrc);
                }
            } catch (error) {
                console.error('L·ªói th√™m game:', error);
                alert('L·ªói th√™m game: ' + error.message);
            }
        }

        function completeAddGame(name, link, imageSrc) {
            const newGame = {
                id: Date.now(),
                name,
                downloadUrl: link,
                image: imageSrc
            };
            
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            games.push(newGame);
            localStorage.setItem('games', JSON.stringify(games));
            
            renderGamesList(games);
            renderGames(games); // Update main games view
            
            // Clear form
            elements.gameName.value = '';
            elements.gameLink.value = '';
            elements.gameImage.value = '';
        }

        async function getGames() {
            return JSON.parse(localStorage.getItem('games') || '[]');
        }

        async function deleteGame(gameId) {
            try {
                const games = JSON.parse(localStorage.getItem('games') || '[]');
                const filteredGames = games.filter(g => g.id !== gameId);
                localStorage.setItem('games', JSON.stringify(filteredGames));
                renderGamesList(filteredGames);
                renderGames(filteredGames); // Update main games view
            } catch (error) {
                console.error('L·ªói x√≥a game:', error);
                alert('L·ªói x√≥a game: ' + error.message);
            }
        }

        // Dev - Clouds management
        async function loadCloudsList() {
            try {
                const cloudsData = JSON.parse(localStorage.getItem('clouds') || '[]');
                renderCloudsList(cloudsData);
            } catch (error) {
                console.error('L·ªói t·∫£i clouds:', error);
            }
        }

        function renderCloudsList(clouds) {
            elements.cloudsList.innerHTML = '';
            
            clouds.forEach(cloud => {
                const cloudItem = document.createElement('div');
                cloudItem.className = 'item';
                cloudItem.innerHTML = `
                    <img src="${cloud.image}" alt="${cloud.name}">
                    <div class="item-info">
                        <h4>${cloud.name}</h4>
                        <p>${cloud.url}</p>
                        <div class="cloud-stats-small">
                            <span>üëç ${cloud.likes || 0}</span>
                            <span>üëé ${cloud.dislikes || 0}</span>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="delete-btn" data-id="${cloud.id}">X√≥a</button>
                    </div>
                `;
                
                const deleteBtn = cloudItem.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteCloud(cloud.id);
                });
                
                elements.cloudsList.appendChild(cloudItem);
            });
        }

        async function addCloud() {
            const name = elements.cloudName.value.trim();
            const link = elements.cloudLink.value.trim();
            const imageFile = elements.cloudImage.files[0];
            
            if (!name || !link) {
                alert('Vui l√≤ng nh·∫≠p t√™n cloud v√† link');
                return;
            }
            
            try {
                let imageSrc = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="200" viewBox="0 0 300 200"%3E%3Crect width="300" height="200" fill="%23006AFF"/%3E%3Ctext x="150" y="100" text-anchor="middle" fill="white" font-size="24"%3E' + encodeURIComponent(name) + '%3C/text%3E%3C/svg%3E';
                
                if (imageFile) {
                    // Convert image to base64 for localStorage
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageSrc = e.target.result;
                        completeAddCloud(name, link, imageSrc);
                    };
                    reader.readAsDataURL(imageFile);
                } else {
                    completeAddCloud(name, link, imageSrc);
                }
            } catch (error) {
                console.error('L·ªói th√™m cloud:', error);
                alert('L·ªói th√™m cloud: ' + error.message);
            }
        }

        function completeAddCloud(name, link, imageSrc) {
            const newCloud = {
                id: Date.now(),
                name,
                url: link,
                image: imageSrc,
                likes: 0,
                dislikes: 0
            };
            
            const clouds = JSON.parse(localStorage.getItem('clouds') || '[]');
            clouds.push(newCloud);
            localStorage.setItem('clouds', JSON.stringify(clouds));
            
            renderCloudsList(clouds);
            renderClouds(clouds); // Update main clouds view
            
            // Clear form
            elements.cloudName.value = '';
            elements.cloudLink.value = '';
            elements.cloudImage.value = '';
        }

        async function getClouds() {
            return JSON.parse(localStorage.getItem('clouds') || '[]');
        }

        async function deleteCloud(cloudId) {
            try {
                const clouds = JSON.parse(localStorage.getItem('clouds') || '[]');
                const filteredClouds = clouds.filter(c => c.id !== cloudId);
                localStorage.setItem('clouds', JSON.stringify(filteredClouds));
                renderCloudsList(filteredClouds);
                renderClouds(filteredClouds); // Update main clouds view
            } catch (error) {
                console.error('L·ªói x√≥a cloud:', error);
                alert('L·ªói x√≥a cloud: ' + error.message);
            }
        }

        // Dev - Groups management
        async function loadGroupsList() {
            try {
                const groupsData = JSON.parse(localStorage.getItem('groups') || '[]');
                renderGroupsList(groupsData);
            } catch (error) {
                console.error('L·ªói t·∫£i groups:', error);
            }
        }

        function renderGroupsList(groups) {
            elements.groupsList.innerHTML = '';
            
            groups.forEach(group => {
                const groupItem = document.createElement('div');
                groupItem.className = 'item';
                groupItem.innerHTML = `
                    <img src="${group.image}" alt="${group.name}">
                    <div class="item-info">
                        <h4>${group.name}</h4>
                        <p>${group.link}</p>
                    </div>
                    <div class="item-actions">
                        <button class="delete-btn" data-id="${group.id}">X√≥a</button>
                    </div>
                `;
                
                const deleteBtn = groupItem.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteGroup(group.id);
                });
                
                elements.groupsList.appendChild(groupItem);
            });
        }

        async function addGroup() {
            const name = elements.groupName.value.trim();
            const link = elements.groupLink.value.trim();
            const imageFile = elements.groupImage.files[0];
            
            if (!name || !link) {
                alert('Vui l√≤ng nh·∫≠p t√™n group v√† link');
                return;
            }
            
            try {
                let imageSrc = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="200" viewBox="0 0 300 200"%3E%3Crect width="300" height="200" fill="%23006AFF"/%3E%3Ctext x="150" y="100" text-anchor="middle" fill="white" font-size="24"%3E' + encodeURIComponent(name) + '%3C/text%3E%3C/svg%3E';
                
                if (imageFile) {
                    // Convert image to base64 for localStorage
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imageSrc = e.target.result;
                        completeAddGroup(name, link, imageSrc);
                    };
                    reader.readAsDataURL(imageFile);
                } else {
                    completeAddGroup(name, link, imageSrc);
                }
            } catch (error) {
                console.error('L·ªói th√™m group:', error);
                alert('L·ªói th√™m group: ' + error.message);
            }
        }

        function completeAddGroup(name, link, imageSrc) {
            const newGroup = {
                id: Date.now(),
                name,
                link,
                image: imageSrc
            };
            
            const groups = JSON.parse(localStorage.getItem('groups') || '[]');
            groups.push(newGroup);
            localStorage.setItem('groups', JSON.stringify(groups));
            
            renderGroupsList(groups);
            renderGroups(groups); // Update main groups view
            
            // Clear form
            elements.groupName.value = '';
            elements.groupLink.value = '';
            elements.groupImage.value = '';
        }

        async function getGroups() {
            return JSON.parse(localStorage.getItem('groups') || '[]');
        }

        async function deleteGroup(groupId) {
            try {
                const groups = JSON.parse(localStorage.getItem('groups') || '[]');
                const filteredGroups = groups.filter(g => g.id !== groupId);
                localStorage.setItem('groups', JSON.stringify(filteredGroups));
                renderGroupsList(filteredGroups);
                renderGroups(filteredGroups); // Update main groups view
            } catch (error) {
                console.error('L·ªói x√≥a group:', error);
                alert('L·ªói x√≥a group: ' + error.message);
            }
        }

        // Dev - Popup settings
        async function loadPopupSettings() {
            try {
                const popupSettings = JSON.parse(localStorage.getItem('popupSettings') || '{}');
                
                if (popupSettings) {
                    elements.popupLink.value = popupSettings.redirectUrl || '';
                    elements.groupLink.value = popupSettings.groupUrl || '';
                }
            } catch (error) {
                console.error('L·ªói t·∫£i popup settings:', error);
            }
        }

        async function savePopupSettings() {
            const avatarFile = elements.popupAvatarInput.files[0];
            const redirectUrl = elements.popupLink.value.trim();
            const groupUrl = elements.groupLink.value.trim();
            
            try {
                let avatarUrl = '';
                
                if (avatarFile) {
                    // Convert image to base64 for localStorage
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        avatarUrl = e.target.result;
                        completeSavePopupSettings(redirectUrl, groupUrl, avatarUrl);
                    };
                    reader.readAsDataURL(avatarFile);
                } else {
                    completeSavePopupSettings(redirectUrl, groupUrl, avatarUrl);
                }
            } catch (error) {
                console.error('L·ªói l∆∞u popup settings:', error);
                alert('L·ªói l∆∞u c√†i ƒë·∫∑t popup: ' + error.message);
            }
        }

        function completeSavePopupSettings(redirectUrl, groupUrl, avatarUrl) {
            const popupSettings = {
                redirectUrl: redirectUrl,
                groupUrl: groupUrl
            };
            
            if (avatarUrl) {
                popupSettings.avatar = avatarUrl;
            }
            
            localStorage.setItem('popupSettings', JSON.stringify(popupSettings));
            alert('C√†i ƒë·∫∑t popup ƒë√£ ƒë∆∞·ª£c l∆∞u');
        }

        // Import/Export
        async function exportData() {
            try {
                const [games, clouds, groups, videos, settings] = await Promise.all([
                    getGames(),
                    getClouds(),
                    getGroups(),
                    getVideos(),
                    Promise.resolve(JSON.parse(localStorage.getItem('popupSettings') || '{}'))
                ]);
                
                const data = {
                    games,
                    clouds,
                    groups,
                    videos,
                    settings
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'game-center-data.json';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('L·ªói export data:', error);
                alert('L·ªói export data: ' + error.message);
            }
        }

        async function importData() {
            const file = elements.importDataInput.files[0];
            
            if (!file) {
                alert('Vui l√≤ng ch·ªçn file JSON ƒë·ªÉ import');
                return;
            }
            
            try {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        // Import data to localStorage
                        if (importedData.games) {
                            localStorage.setItem('games', JSON.stringify(importedData.games));
                        }
                        
                        if (importedData.clouds) {
                            localStorage.setItem('clouds', JSON.stringify(importedData.clouds));
                        }
                        
                        if (importedData.groups) {
                            localStorage.setItem('groups', JSON.stringify(importedData.groups));
                        }
                        
                        if (importedData.videos) {
                            localStorage.setItem('videos', JSON.stringify(importedData.videos));
                        }
                        
                        if (importedData.settings) {
                            localStorage.setItem('popupSettings', JSON.stringify(importedData.settings));
                        }
                        
                        // Refresh views
                        loadGames();
                        loadClouds();
                        loadGroups();
                        loadZaloGroups();
                        loadDevData();
                        
                        alert('D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c import th√†nh c√¥ng');
                    } catch (error) {
                        alert('L·ªói khi import d·ªØ li·ªáu: ' + error.message);
                    }
                };
                
                reader.readAsText(file);
                elements.importDataInput.value = '';
            } catch (error) {
                console.error('L·ªói import data:', error);
                alert('L·ªói import data: ' + error.message);
            }
        }

        // Utility functions
        function showPopup(popup) {
            popup.classList.add('active');
        }

        function hidePopup(popup) {
            popup.classList.remove('active');
        }
    </script>
</body>
</html>
